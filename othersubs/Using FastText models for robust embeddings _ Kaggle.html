<!DOCTYPE html>
<!-- saved from url=(0078)https://www.kaggle.com/mschumacher/using-fasttext-models-for-robust-embeddings -->
<html><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
    <title>Using FastText models for robust embeddings | Kaggle</title>
    
    <meta name="robots" content="index, follow">
<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, minimum-scale=1.0">    <meta name="theme-color" content="#008ABC">
    <link rel="dns-prefetch" href="https://www.google-analytics.com/"><link rel="dns-prefetch" href="https://stats.g.doubleclick.net/"><link rel="dns-prefetch" href="https://js.intercomcdn.com/"><link rel="preload" href="./Using FastText models for robust embeddings _ Kaggle_files/ai.0.js" as="script"><link rel="dns-prefetch" href="https://kaggle2.blob.core.windows.net/">
    <link href="https://www.kaggle.com/content/v/d420a040e581/kaggle/favicon.ico" rel="shortcut icon" type="image/x-icon">
    <link rel="manifest" href="https://www.kaggle.com/static/json/manifest.json">
    <link href="./Using FastText models for robust embeddings _ Kaggle_files/css" rel="stylesheet" type="text/css">
<link rel="canonical" href="https://www.kaggle.com/mschumacher/using-fasttext-models-for-robust-embeddings">                    <link rel="stylesheet" type="text/css" href="./Using FastText models for robust embeddings _ Kaggle_files/vendor.css">
        <link rel="stylesheet" type="text/css" href="./Using FastText models for robust embeddings _ Kaggle_files/app.css">
        <script type="text/javascript" async="" src="./Using FastText models for robust embeddings _ Kaggle_files/koj6gxx6"></script><script async="" src="./Using FastText models for robust embeddings _ Kaggle_files/fbevents.js"></script><script>
            
            (function () {
                var originalError = window.onerror;

                window.onerror = function (message, url, lineNumber, columnNumber, error) {
                    var handled = originalError && originalError(message, url, lineNumber, columnNumber, error);
                    var blockedByCors = message && message.toLowerCase().indexOf("script error") >= 0;
                    return handled || blockedByCors;
                };
            })();
        </script>
    <script>
        var appInsights=window.appInsights||function(config){
        function i(config){t[config]=function(){var i=arguments;t.queue.push(function(){t[config].apply(t,i)})}}var t={config:config},u=document,e=window,o="script",s="AuthenticatedUserContext",h="start",c="stop",l="Track",a=l+"Event",v=l+"Page",y=u.createElement(o),r,f;y.src=config.url||"https://az416426.vo.msecnd.net/scripts/a/ai.0.js";u.getElementsByTagName(o)[0].parentNode.appendChild(y);try{t.cookie=u.cookie}catch(p){}for(t.queue=[],t.version="1.0",r=["Event","Exception","Metric","PageView","Trace","Dependency"];r.length;)i("track"+r.pop());return i("set"+s),i("clear"+s),i(h+a),i(c+a),i(h+v),i(c+v),i("flush"),config.disableExceptionTracking||(r="onerror",i("_"+r),f=e[r],e[r]=function(config,i,u,e,o){var s=f&&f(config,i,u,e,o);return s!==!0&&t["_"+r](config,i,u,e,o),s}),t
        }({
            instrumentationKey:"5b3d6014-f021-4304-8366-3cf961d5b90f",
            disableAjaxTracking: true
        });
        window.appInsights=appInsights;
        appInsights.trackPageView();
    </script><script src="./Using FastText models for robust embeddings _ Kaggle_files/ai.0.js"></script>
    
    
    
 
    
    <script>
    window.ga = window.ga || function () { (ga.q = ga.q || []).push(arguments) }; ga.l = +new Date;
    ga('create', 'UA-12629138-1', 'auto');
    ga('set', 'displayFeaturesTask', null);
    ga('send', 'pageview');
    </script>
    <script async="" src="./Using FastText models for robust embeddings _ Kaggle_files/analytics.js"></script>

    
<script>
    !function(f,b,e,v,n,t,s)
    {if(f.fbq)return;n=f.fbq=function(){n.callMethod?
            n.callMethod.apply(n,arguments):n.queue.push(arguments)};
        if(!f._fbq)f._fbq=n;n.push=n;n.loaded=!0;n.version='2.0';
        n.queue=[];t=b.createElement(e);t.async=!0;
        t.src=v;s=b.getElementsByTagName(e)[0];
        s.parentNode.insertBefore(t,s)}(window,document,'script',
        'https://connect.facebook.net/en_US/fbevents.js');
    fbq("set", "autoConfig", "false", "136809193586742");
    fbq('init', '136809193586742'); 
    fbq('track', 'PageView');
</script>
<noscript>
    &lt;img height="1" width="1" src="https://www.facebook.com/tr?id=136809193586742&amp;ev=PageView&amp;noscript=1"/&gt;
</noscript>

    

    <script>
         window.intercomSettings = {
        app_id: "koj6gxx6",
            name: "JohnM",
            email: "jpmiller.us@gmail.com",
            created_at: 1433078611,
            user_hash: "020d9a379a4b16eac85f9aedf31b4e6ca254eb95c856c771cc381682fea8740a",
            "last_visit_date_at": 1519536024,  
            "is_activated": true,
            "is_locked_out": false,
            "points": 46795,
             "ranking": 79,
             "tier": 4,
             "performance_tier": 2,
             "highest_ranking": 68,
             "user_name": "jpmiller",
             "display_name": "JohnM",
             "is_admin": false,
             "experiment_group": 1,
             "newsletter_subscriber": false,
             "block_emails": false,
                 
                 "competitions_tier": 2,
                 "competitions_tier_attained_at" : 1468555137,
                 "kernels_tier": 2,
                 "kernels_tier_attained_at" : 1497202272,
                 "discussion_tier": 2,
                 "discussion_tier_attained_at" : 1488167829,
                 
                              "datasets_count": 2,
                 "last_dataset_created_at": 1516236817,
                 "last_dataset_validation_error_at": null,
                 "last_new_dataset_visit_at": null,
                 "host_page_visits": 3,
             "delete_account_reason": ""
        };
    </script>
<script>(function(){var w=window;var ic=w.Intercom;if(typeof ic==="function"){ic('reattach_activator');ic('update',intercomSettings);}else{var d=document;var i=function(){i.c(arguments)};i.q=[];i.c=function(args){i.q.push(args)};w.Intercom=i;function l(){var s=d.createElement('script');s.type='text/javascript';s.async=true;s.src='https://widget.intercom.io/widget/koj6gxx6';var x=d.getElementsByTagName('script')[0];x.parentNode.insertBefore(s,x);}if(w.attachEvent){w.attachEvent('onload',l);}else{w.addEventListener('load',l,false);}}})()</script>
    
    
    <meta name="twitter:card" content="summary">
    <meta name="twitter:site" content="@kaggledatasets">
    <meta name="og:url" content="https://www.kaggle.com/mschumacher/using-fasttext-models-for-robust-embeddings">
    <meta name="og:title" content="Using FastText models for robust embeddings">
    <meta name="og:description" content="Using data from Toxic Comment Classification Challenge">
    <meta name="og:image" content="https://kaggle2.blob.core.windows.net/competitions/kaggle/8076/logos/thumb76_76.png?t=2017-12-15-21-29-57">


    
    

    
    

    <script src="./Using FastText models for robust embeddings _ Kaggle_files/manifest.js"></script>
<script src="./Using FastText models for robust embeddings _ Kaggle_files/vendor.js"></script>
<style type="text/css" data-styled-components="" data-styled-components-is-local="true"></style><style type="text/css" data-styled-components="dnInqT" data-styled-components-is-local="true">
/* sc-component-id: SpinnerContainer-rDhjZ */

.dnInqT{color:rgba(0,0,0,0.2);display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;width:100%;-webkit-box-pack:center;-webkit-justify-content:center;-ms-flex-pack:center;justify-content:center;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;min-height:42px;}</style><style type="text/css" data-styled-components="kxcRzO cQHAib brmgEU gAjEXu fmXzjq cAedFl eIqlf" data-styled-components-is-local="true">
/* sc-component-id: SuggestionsWrapper-jrrtHK */

.kxcRzO{font-family:'Atlas Grotesk',sans-serif;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-flex-flow:row wrap;-ms-flex-flow:row wrap;flex-flow:row wrap;-webkit-flex:1 1 auto;-ms-flex:1 1 auto;flex:1 1 auto;-webkit-box-pack:center;-webkit-justify-content:center;-ms-flex-pack:center;justify-content:center;background:#FFFFFF;border-radius:0 0 4px 4px;}
/* sc-component-id: InfoTitle-hwGaFo */

.eIqlf{color:#47494D;font-size:12px;font-weight:500;line-height:1.375;position:relative;overflow:hidden;text-overflow:ellipsis;text-align:center;text-transform:capitalize;}
/* sc-component-id: SuggestionWrapper-bZXlPl */

.cQHAib{background:#FFFFFF;cursor:pointer;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-flex-flow:column wrap;-ms-flex-flow:column wrap;flex-flow:column wrap;-webkit-flex:1 1 auto;-ms-flex:1 1 auto;flex:1 1 auto;-webkit-align-self:stretch;-ms-flex-item-align:stretch;align-self:stretch;padding:16px;position:relative;border-top:1px solid #FFFFFF;border-bottom:1px solid #FFFFFF;-webkit-transition:0.1s color ease;transition:0.1s color ease;width:15%;}.cQHAib:hover{background:fade(rgba(0,0,0,0.03),2);}.cQHAib:hover .InfoTitle-hwGaFo{color:#20BEFF;}.cQHAib:first-child{border-radius:0 0 0 4px;border-top:0;}.cQHAib:last-child{border-radius:0 0 4px 0;}@media only screen and (max-width:768px){.cQHAib{padding:8px 16px;-webkit-align-items:flex-start;-webkit-box-align:flex-start;-ms-flex-align:flex-start;align-items:flex-start;}}
/* sc-component-id: ContentWrapper-bvWSlK */

.brmgEU{max-width:140px;-webkit-align-self:center;-ms-flex-item-align:center;align-self:center;}
/* sc-component-id: SuggestionImageWrapper-jCWKMo */

.gAjEXu{position:relative;-webkit-align-self:center;-ms-flex-item-align:center;align-self:center;margin:auto;width:80px;height:80px;border-radius:80px;font-size:52px;line-height:80px;}@media only screen and (max-width:768px){.gAjEXu{width:64px;height:64px;border-radius:64px;font-size:32px;line-height:64px;}}
/* sc-component-id: SuggestionImage-gkRBSt */

.fmXzjq{border-radius:4px;width:80px;height:80px;}@media only screen and (max-width:768px){.fmXzjq{width:64px;height:64px;}}
/* sc-component-id: InfoWrapper-cgkVcx */

.cAedFl{-webkit-align-self:center;-ms-flex-item-align:center;align-self:center;-webkit-flex-flow:column nowrap;-ms-flex-flow:column nowrap;flex-flow:column nowrap;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;padding-top:8px;}@media only screen and (max-width:768px){.cAedFl{-webkit-order:1;-ms-flex-order:1;order:1;}}</style><style type="text/css" data-styled-components="" data-styled-components-is-local="true"></style><style id="ace_editor.css">.ace_editor {position: relative;overflow: hidden;font: 12px/normal 'Monaco', 'Menlo', 'Ubuntu Mono', 'Consolas', 'source-code-pro', monospace;direction: ltr;}.ace_scroller {position: absolute;overflow: hidden;top: 0;bottom: 0;background-color: inherit;-ms-user-select: none;-moz-user-select: none;-webkit-user-select: none;user-select: none;cursor: text;}.ace_content {position: absolute;-moz-box-sizing: border-box;-webkit-box-sizing: border-box;box-sizing: border-box;min-width: 100%;}.ace_dragging .ace_scroller:before{position: absolute;top: 0;left: 0;right: 0;bottom: 0;content: '';background: rgba(250, 250, 250, 0.01);z-index: 1000;}.ace_dragging.ace_dark .ace_scroller:before{background: rgba(0, 0, 0, 0.01);}.ace_selecting, .ace_selecting * {cursor: text !important;}.ace_gutter {position: absolute;overflow : hidden;width: auto;top: 0;bottom: 0;left: 0;cursor: default;z-index: 4;-ms-user-select: none;-moz-user-select: none;-webkit-user-select: none;user-select: none;}.ace_gutter-active-line {position: absolute;left: 0;right: 0;}.ace_scroller.ace_scroll-left {box-shadow: 17px 0 16px -16px rgba(0, 0, 0, 0.4) inset;}.ace_gutter-cell {padding-left: 19px;padding-right: 6px;background-repeat: no-repeat;}.ace_gutter-cell.ace_error {background-image: url("data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAMAAAAoLQ9TAAABOFBMVEX/////////QRswFAb/Ui4wFAYwFAYwFAaWGAfDRymzOSH/PxswFAb/SiUwFAYwFAbUPRvjQiDllog5HhHdRybsTi3/Tyv9Tir+Syj/UC3////XurebMBIwFAb/RSHbPx/gUzfdwL3kzMivKBAwFAbbvbnhPx66NhowFAYwFAaZJg8wFAaxKBDZurf/RB6mMxb/SCMwFAYwFAbxQB3+RB4wFAb/Qhy4Oh+4QifbNRcwFAYwFAYwFAb/QRzdNhgwFAYwFAbav7v/Uy7oaE68MBK5LxLewr/r2NXewLswFAaxJw4wFAbkPRy2PyYwFAaxKhLm1tMwFAazPiQwFAaUGAb/QBrfOx3bvrv/VC/maE4wFAbRPBq6MRO8Qynew8Dp2tjfwb0wFAbx6eju5+by6uns4uH9/f36+vr/GkHjAAAAYnRSTlMAGt+64rnWu/bo8eAA4InH3+DwoN7j4eLi4xP99Nfg4+b+/u9B/eDs1MD1mO7+4PHg2MXa347g7vDizMLN4eG+Pv7i5evs/v79yu7S3/DV7/498Yv24eH+4ufQ3Ozu/v7+y13sRqwAAADLSURBVHjaZc/XDsFgGIBhtDrshlitmk2IrbHFqL2pvXf/+78DPokj7+Fz9qpU/9UXJIlhmPaTaQ6QPaz0mm+5gwkgovcV6GZzd5JtCQwgsxoHOvJO15kleRLAnMgHFIESUEPmawB9ngmelTtipwwfASilxOLyiV5UVUyVAfbG0cCPHig+GBkzAENHS0AstVF6bacZIOzgLmxsHbt2OecNgJC83JERmePUYq8ARGkJx6XtFsdddBQgZE2nPR6CICZhawjA4Fb/chv+399kfR+MMMDGOQAAAABJRU5ErkJggg==");background-repeat: no-repeat;background-position: 2px center;}.ace_gutter-cell.ace_warning {background-image: url("data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAMAAAAoLQ9TAAAAmVBMVEX///8AAAD///8AAAAAAABPSzb/5sAAAAB/blH/73z/ulkAAAAAAAD85pkAAAAAAAACAgP/vGz/rkDerGbGrV7/pkQICAf////e0IsAAAD/oED/qTvhrnUAAAD/yHD/njcAAADuv2r/nz//oTj/p064oGf/zHAAAAA9Nir/tFIAAAD/tlTiuWf/tkIAAACynXEAAAAAAAAtIRW7zBpBAAAAM3RSTlMAABR1m7RXO8Ln31Z36zT+neXe5OzooRDfn+TZ4p3h2hTf4t3k3ucyrN1K5+Xaks52Sfs9CXgrAAAAjklEQVR42o3PbQ+CIBQFYEwboPhSYgoYunIqqLn6/z8uYdH8Vmdnu9vz4WwXgN/xTPRD2+sgOcZjsge/whXZgUaYYvT8QnuJaUrjrHUQreGczuEafQCO/SJTufTbroWsPgsllVhq3wJEk2jUSzX3CUEDJC84707djRc5MTAQxoLgupWRwW6UB5fS++NV8AbOZgnsC7BpEAAAAABJRU5ErkJggg==");background-position: 2px center;}.ace_gutter-cell.ace_info {background-image: url("data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAAAAAA6mKC9AAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAAAJ0Uk5TAAB2k804AAAAPklEQVQY02NgIB68QuO3tiLznjAwpKTgNyDbMegwisCHZUETUZV0ZqOquBpXj2rtnpSJT1AEnnRmL2OgGgAAIKkRQap2htgAAAAASUVORK5CYII=");background-position: 2px center;}.ace_dark .ace_gutter-cell.ace_info {background-image: url("data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQBAMAAADt3eJSAAAAJFBMVEUAAAChoaGAgIAqKiq+vr6tra1ZWVmUlJSbm5s8PDxubm56enrdgzg3AAAAAXRSTlMAQObYZgAAAClJREFUeNpjYMAPdsMYHegyJZFQBlsUlMFVCWUYKkAZMxZAGdxlDMQBAG+TBP4B6RyJAAAAAElFTkSuQmCC");}.ace_scrollbar {position: absolute;right: 0;bottom: 0;z-index: 6;}.ace_scrollbar-inner {position: absolute;cursor: text;left: 0;top: 0;}.ace_scrollbar-v{overflow-x: hidden;overflow-y: scroll;top: 0;}.ace_scrollbar-h {overflow-x: scroll;overflow-y: hidden;left: 0;}.ace_print-margin {position: absolute;height: 100%;}.ace_text-input {position: absolute;z-index: 0;width: 0.5em;height: 1em;opacity: 0;background: transparent;-moz-appearance: none;appearance: none;border: none;resize: none;outline: none;overflow: hidden;font: inherit;padding: 0 1px;margin: 0 -1px;text-indent: -1em;-ms-user-select: text;-moz-user-select: text;-webkit-user-select: text;user-select: text;white-space: pre!important;}.ace_text-input.ace_composition {background: inherit;color: inherit;z-index: 1000;opacity: 1;text-indent: 0;}.ace_layer {z-index: 1;position: absolute;overflow: hidden;word-wrap: normal;white-space: pre;height: 100%;width: 100%;-moz-box-sizing: border-box;-webkit-box-sizing: border-box;box-sizing: border-box;pointer-events: none;}.ace_gutter-layer {position: relative;width: auto;text-align: right;pointer-events: auto;}.ace_text-layer {font: inherit !important;}.ace_cjk {display: inline-block;text-align: center;}.ace_cursor-layer {z-index: 4;}.ace_cursor {z-index: 4;position: absolute;-moz-box-sizing: border-box;-webkit-box-sizing: border-box;box-sizing: border-box;border-left: 2px solid;transform: translatez(0);}.ace_slim-cursors .ace_cursor {border-left-width: 1px;}.ace_overwrite-cursors .ace_cursor {border-left-width: 0;border-bottom: 1px solid;}.ace_hidden-cursors .ace_cursor {opacity: 0.2;}.ace_smooth-blinking .ace_cursor {-webkit-transition: opacity 0.18s;transition: opacity 0.18s;}.ace_editor.ace_multiselect .ace_cursor {border-left-width: 1px;}.ace_marker-layer .ace_step, .ace_marker-layer .ace_stack {position: absolute;z-index: 3;}.ace_marker-layer .ace_selection {position: absolute;z-index: 5;}.ace_marker-layer .ace_bracket {position: absolute;z-index: 6;}.ace_marker-layer .ace_active-line {position: absolute;z-index: 2;}.ace_marker-layer .ace_selected-word {position: absolute;z-index: 4;-moz-box-sizing: border-box;-webkit-box-sizing: border-box;box-sizing: border-box;}.ace_line .ace_fold {-moz-box-sizing: border-box;-webkit-box-sizing: border-box;box-sizing: border-box;display: inline-block;height: 11px;margin-top: -2px;vertical-align: middle;background-image:url("data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABEAAAAJCAYAAADU6McMAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAAJpJREFUeNpi/P//PwOlgAXGYGRklAVSokD8GmjwY1wasKljQpYACtpCFeADcHVQfQyMQAwzwAZI3wJKvCLkfKBaMSClBlR7BOQikCFGQEErIH0VqkabiGCAqwUadAzZJRxQr/0gwiXIal8zQQPnNVTgJ1TdawL0T5gBIP1MUJNhBv2HKoQHHjqNrA4WO4zY0glyNKLT2KIfIMAAQsdgGiXvgnYAAAAASUVORK5CYII="),url("data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAA3CAYAAADNNiA5AAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAACJJREFUeNpi+P//fxgTAwPDBxDxD078RSX+YeEyDFMCIMAAI3INmXiwf2YAAAAASUVORK5CYII=");background-repeat: no-repeat, repeat-x;background-position: center center, top left;color: transparent;border: 1px solid black;border-radius: 2px;cursor: pointer;pointer-events: auto;}.ace_dark .ace_fold {}.ace_fold:hover{background-image:url("data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABEAAAAJCAYAAADU6McMAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAAJpJREFUeNpi/P//PwOlgAXGYGRklAVSokD8GmjwY1wasKljQpYACtpCFeADcHVQfQyMQAwzwAZI3wJKvCLkfKBaMSClBlR7BOQikCFGQEErIH0VqkabiGCAqwUadAzZJRxQr/0gwiXIal8zQQPnNVTgJ1TdawL0T5gBIP1MUJNhBv2HKoQHHjqNrA4WO4zY0glyNKLT2KIfIMAAQsdgGiXvgnYAAAAASUVORK5CYII="),url("data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAA3CAYAAADNNiA5AAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAACBJREFUeNpi+P//fz4TAwPDZxDxD5X4i5fLMEwJgAADAEPVDbjNw87ZAAAAAElFTkSuQmCC");}.ace_tooltip {background-color: #FFF;background-image: -webkit-linear-gradient(top, transparent, rgba(0, 0, 0, 0.1));background-image: linear-gradient(to bottom, transparent, rgba(0, 0, 0, 0.1));border: 1px solid gray;border-radius: 1px;box-shadow: 0 1px 2px rgba(0, 0, 0, 0.3);color: black;max-width: 100%;padding: 3px 4px;position: fixed;z-index: 999999;-moz-box-sizing: border-box;-webkit-box-sizing: border-box;box-sizing: border-box;cursor: default;white-space: pre;word-wrap: break-word;line-height: normal;font-style: normal;font-weight: normal;letter-spacing: normal;pointer-events: none;}.ace_folding-enabled > .ace_gutter-cell {padding-right: 13px;}.ace_fold-widget {-moz-box-sizing: border-box;-webkit-box-sizing: border-box;box-sizing: border-box;margin: 0 -12px 0 1px;display: none;width: 11px;vertical-align: top;background-image: url("data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAUAAAAFCAYAAACNbyblAAAANElEQVR42mWKsQ0AMAzC8ixLlrzQjzmBiEjp0A6WwBCSPgKAXoLkqSot7nN3yMwR7pZ32NzpKkVoDBUxKAAAAABJRU5ErkJggg==");background-repeat: no-repeat;background-position: center;border-radius: 3px;border: 1px solid transparent;cursor: pointer;}.ace_folding-enabled .ace_fold-widget {display: inline-block;   }.ace_fold-widget.ace_end {background-image: url("data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAUAAAAFCAYAAACNbyblAAAANElEQVR42m3HwQkAMAhD0YzsRchFKI7sAikeWkrxwScEB0nh5e7KTPWimZki4tYfVbX+MNl4pyZXejUO1QAAAABJRU5ErkJggg==");}.ace_fold-widget.ace_closed {background-image: url("data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAMAAAAGCAYAAAAG5SQMAAAAOUlEQVR42jXKwQkAMAgDwKwqKD4EwQ26sSOkVWjgIIHAzPiCgaqiqnJHZnKICBERHN194O5b9vbLuAVRL+l0YWnZAAAAAElFTkSuQmCCXA==");}.ace_fold-widget:hover {border: 1px solid rgba(0, 0, 0, 0.3);background-color: rgba(255, 255, 255, 0.2);box-shadow: 0 1px 1px rgba(255, 255, 255, 0.7);}.ace_fold-widget:active {border: 1px solid rgba(0, 0, 0, 0.4);background-color: rgba(0, 0, 0, 0.05);box-shadow: 0 1px 1px rgba(255, 255, 255, 0.8);}.ace_dark .ace_fold-widget {background-image: url("data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAUAAAAFCAYAAACNbyblAAAAHklEQVQIW2P4//8/AzoGEQ7oGCaLLAhWiSwB146BAQCSTPYocqT0AAAAAElFTkSuQmCC");}.ace_dark .ace_fold-widget.ace_end {background-image: url("data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAUAAAAFCAYAAACNbyblAAAAH0lEQVQIW2P4//8/AxQ7wNjIAjDMgC4AxjCVKBirIAAF0kz2rlhxpAAAAABJRU5ErkJggg==");}.ace_dark .ace_fold-widget.ace_closed {background-image: url("data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAMAAAAFCAYAAACAcVaiAAAAHElEQVQIW2P4//+/AxAzgDADlOOAznHAKgPWAwARji8UIDTfQQAAAABJRU5ErkJggg==");}.ace_dark .ace_fold-widget:hover {box-shadow: 0 1px 1px rgba(255, 255, 255, 0.2);background-color: rgba(255, 255, 255, 0.1);}.ace_dark .ace_fold-widget:active {box-shadow: 0 1px 1px rgba(255, 255, 255, 0.2);}.ace_fold-widget.ace_invalid {background-color: #FFB4B4;border-color: #DE5555;}.ace_fade-fold-widgets .ace_fold-widget {-webkit-transition: opacity 0.4s ease 0.05s;transition: opacity 0.4s ease 0.05s;opacity: 0;}.ace_fade-fold-widgets:hover .ace_fold-widget {-webkit-transition: opacity 0.05s ease 0.05s;transition: opacity 0.05s ease 0.05s;opacity:1;}.ace_underline {text-decoration: underline;}.ace_bold {font-weight: bold;}.ace_nobold .ace_bold {font-weight: normal;}.ace_italic {font-style: italic;}.ace_error-marker {background-color: rgba(255, 0, 0,0.2);position: absolute;z-index: 9;}.ace_highlight-marker {background-color: rgba(255, 255, 0,0.2);position: absolute;z-index: 8;}.ace_br1 {border-top-left-radius    : 3px;}.ace_br2 {border-top-right-radius   : 3px;}.ace_br3 {border-top-left-radius    : 3px; border-top-right-radius:    3px;}.ace_br4 {border-bottom-right-radius: 3px;}.ace_br5 {border-top-left-radius    : 3px; border-bottom-right-radius: 3px;}.ace_br6 {border-top-right-radius   : 3px; border-bottom-right-radius: 3px;}.ace_br7 {border-top-left-radius    : 3px; border-top-right-radius:    3px; border-bottom-right-radius: 3px;}.ace_br8 {border-bottom-left-radius : 3px;}.ace_br9 {border-top-left-radius    : 3px; border-bottom-left-radius:  3px;}.ace_br10{border-top-right-radius   : 3px; border-bottom-left-radius:  3px;}.ace_br11{border-top-left-radius    : 3px; border-top-right-radius:    3px; border-bottom-left-radius:  3px;}.ace_br12{border-bottom-right-radius: 3px; border-bottom-left-radius:  3px;}.ace_br13{border-top-left-radius    : 3px; border-bottom-right-radius: 3px; border-bottom-left-radius:  3px;}.ace_br14{border-top-right-radius   : 3px; border-bottom-right-radius: 3px; border-bottom-left-radius:  3px;}.ace_br15{border-top-left-radius    : 3px; border-top-right-radius:    3px; border-bottom-right-radius: 3px; border-bottom-left-radius: 3px;}
/*# sourceURL=ace/css/ace_editor.css */</style><style id="ace-tm">.ace-tm .ace_gutter {background: #f0f0f0;color: #333;}.ace-tm .ace_print-margin {width: 1px;background: #e8e8e8;}.ace-tm .ace_fold {background-color: #6B72E6;}.ace-tm {background-color: #FFFFFF;color: black;}.ace-tm .ace_cursor {color: black;}.ace-tm .ace_invisible {color: rgb(191, 191, 191);}.ace-tm .ace_storage,.ace-tm .ace_keyword {color: blue;}.ace-tm .ace_constant {color: rgb(197, 6, 11);}.ace-tm .ace_constant.ace_buildin {color: rgb(88, 72, 246);}.ace-tm .ace_constant.ace_language {color: rgb(88, 92, 246);}.ace-tm .ace_constant.ace_library {color: rgb(6, 150, 14);}.ace-tm .ace_invalid {background-color: rgba(255, 0, 0, 0.1);color: red;}.ace-tm .ace_support.ace_function {color: rgb(60, 76, 114);}.ace-tm .ace_support.ace_constant {color: rgb(6, 150, 14);}.ace-tm .ace_support.ace_type,.ace-tm .ace_support.ace_class {color: rgb(109, 121, 222);}.ace-tm .ace_keyword.ace_operator {color: rgb(104, 118, 135);}.ace-tm .ace_string {color: rgb(3, 106, 7);}.ace-tm .ace_comment {color: rgb(76, 136, 107);}.ace-tm .ace_comment.ace_doc {color: rgb(0, 102, 255);}.ace-tm .ace_comment.ace_doc.ace_tag {color: rgb(128, 159, 191);}.ace-tm .ace_constant.ace_numeric {color: rgb(0, 0, 205);}.ace-tm .ace_variable {color: rgb(49, 132, 149);}.ace-tm .ace_xml-pe {color: rgb(104, 104, 91);}.ace-tm .ace_entity.ace_name.ace_function {color: #0000A2;}.ace-tm .ace_heading {color: rgb(12, 7, 255);}.ace-tm .ace_list {color:rgb(185, 6, 144);}.ace-tm .ace_meta.ace_tag {color:rgb(0, 22, 142);}.ace-tm .ace_string.ace_regex {color: rgb(255, 0, 0)}.ace-tm .ace_marker-layer .ace_selection {background: rgb(181, 213, 255);}.ace-tm.ace_multiselect .ace_selection.ace_start {box-shadow: 0 0 3px 0px white;}.ace-tm .ace_marker-layer .ace_step {background: rgb(252, 255, 0);}.ace-tm .ace_marker-layer .ace_stack {background: rgb(164, 229, 101);}.ace-tm .ace_marker-layer .ace_bracket {margin: -1px 0 0 -1px;border: 1px solid rgb(192, 192, 192);}.ace-tm .ace_marker-layer .ace_active-line {background: rgba(0, 0, 0, 0.07);}.ace-tm .ace_gutter-active-line {background-color : #dcdcdc;}.ace-tm .ace_marker-layer .ace_selected-word {background: rgb(250, 250, 255);border: 1px solid rgb(200, 200, 250);}.ace-tm .ace_indent-guide {background: url("data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAACCAYAAACZgbYnAAAAE0lEQVQImWP4////f4bLly//BwAmVgd1/w11/gAAAABJRU5ErkJggg==") right repeat-y;}
/*# sourceURL=ace/css/ace-tm */</style><style>    .error_widget_wrapper {        background: inherit;        color: inherit;        border:none    }    .error_widget {        border-top: solid 2px;        border-bottom: solid 2px;        margin: 5px 0;        padding: 10px 40px;        white-space: pre-wrap;    }    .error_widget.ace_error, .error_widget_arrow.ace_error{        border-color: #ff5a5a    }    .error_widget.ace_warning, .error_widget_arrow.ace_warning{        border-color: #F1D817    }    .error_widget.ace_info, .error_widget_arrow.ace_info{        border-color: #5a5a5a    }    .error_widget.ace_ok, .error_widget_arrow.ace_ok{        border-color: #5aaa5a    }    .error_widget_arrow {        position: absolute;        border: solid 5px;        border-top-color: transparent!important;        border-right-color: transparent!important;        border-left-color: transparent!important;        top: -5px;    }</style><style>.ace_snippet-marker {    -moz-box-sizing: border-box;    box-sizing: border-box;    background: rgba(194, 193, 208, 0.09);    border: 1px dotted rgba(211, 208, 235, 0.62);    position: absolute;}</style><style>.ace_editor.ace_autocomplete .ace_marker-layer .ace_active-line {    background-color: #CAD6FA;    z-index: 1;}.ace_editor.ace_autocomplete .ace_line-hover {    border: 1px solid #abbffe;    margin-top: -1px;    background: rgba(233,233,253,0.4);}.ace_editor.ace_autocomplete .ace_line-hover {    position: absolute;    z-index: 2;}.ace_editor.ace_autocomplete .ace_scroller {   background: none;   border: none;   box-shadow: none;}.ace_rightAlignedText {    color: gray;    display: inline-block;    position: absolute;    right: 4px;    text-align: right;    z-index: -1;}.ace_editor.ace_autocomplete .ace_completion-highlight{    color: #000;    text-shadow: 0 0 0.01em;}.ace_editor.ace_autocomplete {    width: 280px;    z-index: 200000;    background: #fbfbfb;    color: #444;    border: 1px lightgray solid;    position: fixed;    box-shadow: 2px 3px 5px rgba(0,0,0,.2);    line-height: 1.4;}</style><style type="text/css" data-styled-components="" data-styled-components-is-local="true"></style><style type="text/css" data-styled-components="" data-styled-components-is-local="true"></style><style type="text/css" data-styled-components="" data-styled-components-is-local="true"></style><style type="text/css" data-styled-components="" data-styled-components-is-local="true"></style><style type="text/css" data-styled-components="" data-styled-components-is-local="true"></style><style type="text/css" data-styled-components="" data-styled-components-is-local="true"></style><style type="text/css" data-styled-components="" data-styled-components-is-local="true"></style><style type="text/css" data-styled-components="" data-styled-components-is-local="true"></style><style type="text/css" data-styled-components="" data-styled-components-is-local="true"></style><style type="text/css" data-styled-components="" data-styled-components-is-local="true"></style><style type="text/css">.MathJax_Hover_Frame {border-radius: .25em; -webkit-border-radius: .25em; -moz-border-radius: .25em; -khtml-border-radius: .25em; box-shadow: 0px 0px 15px #83A; -webkit-box-shadow: 0px 0px 15px #83A; -moz-box-shadow: 0px 0px 15px #83A; -khtml-box-shadow: 0px 0px 15px #83A; border: 1px solid #A6D ! important; display: inline-block; position: absolute}
.MathJax_Menu_Button .MathJax_Hover_Arrow {position: absolute; cursor: pointer; display: inline-block; border: 2px solid #AAA; border-radius: 4px; -webkit-border-radius: 4px; -moz-border-radius: 4px; -khtml-border-radius: 4px; font-family: 'Courier New',Courier; font-size: 9px; color: #F0F0F0}
.MathJax_Menu_Button .MathJax_Hover_Arrow span {display: block; background-color: #AAA; border: 1px solid; border-radius: 3px; line-height: 0; padding: 4px}
.MathJax_Hover_Arrow:hover {color: white!important; border: 2px solid #CCC!important}
.MathJax_Hover_Arrow:hover span {background-color: #CCC!important}
</style><style type="text/css">#MathJax_About {position: fixed; left: 50%; width: auto; text-align: center; border: 3px outset; padding: 1em 2em; background-color: #DDDDDD; color: black; cursor: default; font-family: message-box; font-size: 120%; font-style: normal; text-indent: 0; text-transform: none; line-height: normal; letter-spacing: normal; word-spacing: normal; word-wrap: normal; white-space: nowrap; float: none; z-index: 201; border-radius: 15px; -webkit-border-radius: 15px; -moz-border-radius: 15px; -khtml-border-radius: 15px; box-shadow: 0px 10px 20px #808080; -webkit-box-shadow: 0px 10px 20px #808080; -moz-box-shadow: 0px 10px 20px #808080; -khtml-box-shadow: 0px 10px 20px #808080; filter: progid:DXImageTransform.Microsoft.dropshadow(OffX=2, OffY=2, Color='gray', Positive='true')}
#MathJax_About.MathJax_MousePost {outline: none}
.MathJax_Menu {position: absolute; background-color: white; color: black; width: auto; padding: 5px 0px; border: 1px solid #CCCCCC; margin: 0; cursor: default; font: menu; text-align: left; text-indent: 0; text-transform: none; line-height: normal; letter-spacing: normal; word-spacing: normal; word-wrap: normal; white-space: nowrap; float: none; z-index: 201; border-radius: 5px; -webkit-border-radius: 5px; -moz-border-radius: 5px; -khtml-border-radius: 5px; box-shadow: 0px 10px 20px #808080; -webkit-box-shadow: 0px 10px 20px #808080; -moz-box-shadow: 0px 10px 20px #808080; -khtml-box-shadow: 0px 10px 20px #808080; filter: progid:DXImageTransform.Microsoft.dropshadow(OffX=2, OffY=2, Color='gray', Positive='true')}
.MathJax_MenuItem {padding: 1px 2em; background: transparent}
.MathJax_MenuArrow {position: absolute; right: .5em; padding-top: .25em; color: #666666; font-size: .75em}
.MathJax_MenuActive .MathJax_MenuArrow {color: white}
.MathJax_MenuArrow.RTL {left: .5em; right: auto}
.MathJax_MenuCheck {position: absolute; left: .7em}
.MathJax_MenuCheck.RTL {right: .7em; left: auto}
.MathJax_MenuRadioCheck {position: absolute; left: .7em}
.MathJax_MenuRadioCheck.RTL {right: .7em; left: auto}
.MathJax_MenuLabel {padding: 1px 2em 3px 1.33em; font-style: italic}
.MathJax_MenuRule {border-top: 1px solid #DDDDDD; margin: 4px 3px}
.MathJax_MenuDisabled {color: GrayText}
.MathJax_MenuActive {background-color: #606872; color: white}
.MathJax_MenuDisabled:focus, .MathJax_MenuLabel:focus {background-color: #E8E8E8}
.MathJax_ContextMenu:focus {outline: none}
.MathJax_ContextMenu .MathJax_MenuItem:focus {outline: none}
#MathJax_AboutClose {top: .2em; right: .2em}
.MathJax_Menu .MathJax_MenuClose {top: -10px; left: -10px}
.MathJax_MenuClose {position: absolute; cursor: pointer; display: inline-block; border: 2px solid #AAA; border-radius: 18px; -webkit-border-radius: 18px; -moz-border-radius: 18px; -khtml-border-radius: 18px; font-family: 'Courier New',Courier; font-size: 24px; color: #F0F0F0}
.MathJax_MenuClose span {display: block; background-color: #AAA; border: 1.5px solid; border-radius: 18px; -webkit-border-radius: 18px; -moz-border-radius: 18px; -khtml-border-radius: 18px; line-height: 0; padding: 8px 0 6px}
.MathJax_MenuClose:hover {color: white!important; border: 2px solid #CCC!important}
.MathJax_MenuClose:hover span {background-color: #CCC!important}
.MathJax_MenuClose:hover:focus {outline: none}
</style><style type="text/css">.MathJax_Preview .MJXf-math {color: inherit!important}
</style><style type="text/css">.MJX_Assistive_MathML {position: absolute!important; top: 0; left: 0; clip: rect(1px, 1px, 1px, 1px); padding: 1px 0 0 0!important; border: 0!important; height: 1px!important; width: 1px!important; overflow: hidden!important; display: block!important; -webkit-touch-callout: none; -webkit-user-select: none; -khtml-user-select: none; -moz-user-select: none; -ms-user-select: none; user-select: none}
.MJX_Assistive_MathML.MJX_Assistive_MathML_Block {width: 100%!important}
</style><style type="text/css">#MathJax_Zoom {position: absolute; background-color: #F0F0F0; overflow: auto; display: block; z-index: 301; padding: .5em; border: 1px solid black; margin: 0; font-weight: normal; font-style: normal; text-align: left; text-indent: 0; text-transform: none; line-height: normal; letter-spacing: normal; word-spacing: normal; word-wrap: normal; white-space: nowrap; float: none; -webkit-box-sizing: content-box; -moz-box-sizing: content-box; box-sizing: content-box; box-shadow: 5px 5px 15px #AAAAAA; -webkit-box-shadow: 5px 5px 15px #AAAAAA; -moz-box-shadow: 5px 5px 15px #AAAAAA; -khtml-box-shadow: 5px 5px 15px #AAAAAA; filter: progid:DXImageTransform.Microsoft.dropshadow(OffX=2, OffY=2, Color='gray', Positive='true')}
#MathJax_ZoomOverlay {position: absolute; left: 0; top: 0; z-index: 300; display: inline-block; width: 100%; height: 100%; border: 0; padding: 0; margin: 0; background-color: white; opacity: 0; filter: alpha(opacity=0)}
#MathJax_ZoomFrame {position: relative; display: inline-block; height: 0; width: 0}
#MathJax_ZoomEventTrap {position: absolute; left: 0; top: 0; z-index: 302; display: inline-block; border: 0; padding: 0; margin: 0; background-color: white; opacity: 0; filter: alpha(opacity=0)}
</style><style type="text/css">.MathJax_Preview {color: #888}
#MathJax_Message {position: fixed; left: 1em; bottom: 1.5em; background-color: #E6E6E6; border: 1px solid #959595; margin: 0px; padding: 2px 8px; z-index: 102; color: black; font-size: 80%; width: auto; white-space: nowrap}
#MathJax_MSIE_Frame {position: absolute; top: 0; left: 0; width: 0px; z-index: 101; border: 0px; margin: 0px; padding: 0px}
.MathJax_Error {color: #CC0000; font-style: italic}
</style><style type="text/css">.MJXp-script {font-size: .8em}
.MJXp-right {-webkit-transform-origin: right; -moz-transform-origin: right; -ms-transform-origin: right; -o-transform-origin: right; transform-origin: right}
.MJXp-bold {font-weight: bold}
.MJXp-italic {font-style: italic}
.MJXp-scr {font-family: MathJax_Script,'Times New Roman',Times,STIXGeneral,serif}
.MJXp-frak {font-family: MathJax_Fraktur,'Times New Roman',Times,STIXGeneral,serif}
.MJXp-sf {font-family: MathJax_SansSerif,'Times New Roman',Times,STIXGeneral,serif}
.MJXp-cal {font-family: MathJax_Caligraphic,'Times New Roman',Times,STIXGeneral,serif}
.MJXp-mono {font-family: MathJax_Typewriter,'Times New Roman',Times,STIXGeneral,serif}
.MJXp-largeop {font-size: 150%}
.MJXp-largeop.MJXp-int {vertical-align: -.2em}
.MJXp-math {display: inline-block; line-height: 1.2; text-indent: 0; font-family: 'Times New Roman',Times,STIXGeneral,serif; white-space: nowrap; border-collapse: collapse}
.MJXp-display {display: block; text-align: center; margin: 1em 0}
.MJXp-math span {display: inline-block}
.MJXp-box {display: block!important; text-align: center}
.MJXp-box:after {content: " "}
.MJXp-rule {display: block!important; margin-top: .1em}
.MJXp-char {display: block!important}
.MJXp-mo {margin: 0 .15em}
.MJXp-mfrac {margin: 0 .125em; vertical-align: .25em}
.MJXp-denom {display: inline-table!important; width: 100%}
.MJXp-denom > * {display: table-row!important}
.MJXp-surd {vertical-align: top}
.MJXp-surd > * {display: block!important}
.MJXp-script-box > *  {display: table!important; height: 50%}
.MJXp-script-box > * > * {display: table-cell!important; vertical-align: top}
.MJXp-script-box > *:last-child > * {vertical-align: bottom}
.MJXp-script-box > * > * > * {display: block!important}
.MJXp-mphantom {visibility: hidden}
.MJXp-munderover {display: inline-table!important}
.MJXp-over {display: inline-block!important; text-align: center}
.MJXp-over > * {display: block!important}
.MJXp-munderover > * {display: table-row!important}
.MJXp-mtable {vertical-align: .25em; margin: 0 .125em}
.MJXp-mtable > * {display: inline-table!important; vertical-align: middle}
.MJXp-mtr {display: table-row!important}
.MJXp-mtd {display: table-cell!important; text-align: center; padding: .5em 0 0 .5em}
.MJXp-mtr > .MJXp-mtd:first-child {padding-left: 0}
.MJXp-mtr:first-child > .MJXp-mtd {padding-top: 0}
.MJXp-mlabeledtr {display: table-row!important}
.MJXp-mlabeledtr > .MJXp-mtd:first-child {padding-left: 0}
.MJXp-mlabeledtr:first-child > .MJXp-mtd {padding-top: 0}
.MJXp-merror {background-color: #FFFF88; color: #CC0000; border: 1px solid #CC0000; padding: 1px 3px; font-style: normal; font-size: 90%}
.MJXp-scale0 {-webkit-transform: scaleX(.0); -moz-transform: scaleX(.0); -ms-transform: scaleX(.0); -o-transform: scaleX(.0); transform: scaleX(.0)}
.MJXp-scale1 {-webkit-transform: scaleX(.1); -moz-transform: scaleX(.1); -ms-transform: scaleX(.1); -o-transform: scaleX(.1); transform: scaleX(.1)}
.MJXp-scale2 {-webkit-transform: scaleX(.2); -moz-transform: scaleX(.2); -ms-transform: scaleX(.2); -o-transform: scaleX(.2); transform: scaleX(.2)}
.MJXp-scale3 {-webkit-transform: scaleX(.3); -moz-transform: scaleX(.3); -ms-transform: scaleX(.3); -o-transform: scaleX(.3); transform: scaleX(.3)}
.MJXp-scale4 {-webkit-transform: scaleX(.4); -moz-transform: scaleX(.4); -ms-transform: scaleX(.4); -o-transform: scaleX(.4); transform: scaleX(.4)}
.MJXp-scale5 {-webkit-transform: scaleX(.5); -moz-transform: scaleX(.5); -ms-transform: scaleX(.5); -o-transform: scaleX(.5); transform: scaleX(.5)}
.MJXp-scale6 {-webkit-transform: scaleX(.6); -moz-transform: scaleX(.6); -ms-transform: scaleX(.6); -o-transform: scaleX(.6); transform: scaleX(.6)}
.MJXp-scale7 {-webkit-transform: scaleX(.7); -moz-transform: scaleX(.7); -ms-transform: scaleX(.7); -o-transform: scaleX(.7); transform: scaleX(.7)}
.MJXp-scale8 {-webkit-transform: scaleX(.8); -moz-transform: scaleX(.8); -ms-transform: scaleX(.8); -o-transform: scaleX(.8); transform: scaleX(.8)}
.MJXp-scale9 {-webkit-transform: scaleX(.9); -moz-transform: scaleX(.9); -ms-transform: scaleX(.9); -o-transform: scaleX(.9); transform: scaleX(.9)}
.MathJax_PHTML .noError {vertical-align: ; font-size: 90%; text-align: left; color: black; padding: 1px 3px; border: 1px solid}
</style></head>
<body><div id="MathJax_Message" style="display: none;"></div>
    








<div class="site-layout">
        <div class="site-layout__header">
            <div data-component-name="SiteHeaderContainer" style="display: flex; flex-direction: column; flex: 1 0 auto;"><div data-reactroot="" class="site-header-react"><div class="site-header-react__container false"><div class="site-header-react__content"><div class="site-header-react__logo"><a href="https://www.kaggle.com/"><img alt="Kaggle" src="./Using FastText models for robust embeddings _ Kaggle_files/site-logo.png"></a></div><div class="site-header-react__quick-search"><div class="quick-search undefined quick-search--dark false undefined"><div class="quick-search__search-box-container"><input type="text" class="quick-search__search-box " placeholder="Search kaggle" tabindex="1"><div class="quick-search__button"><i class="fa fa-search"></i></div></div><!-- react-empty: 13 --></div></div><nav class="site-header-react__nav"><li class="site-header-react__nav-item"><a href="https://www.kaggle.com/competitions">Competitions</a></li><li class="site-header-react__nav-item"><a href="https://www.kaggle.com/datasets">Datasets</a></li><li class="site-header-react__nav-item"><a href="https://www.kaggle.com/kernels">Kernels</a></li><li class="site-header-react__nav-item"><a href="https://www.kaggle.com/discussion">Discussion</a></li><li class="site-header-react__nav-item"><a href="https://www.kaggle.com/jobs">Jobs</a></li><li class="site-header-react__nav-item"><a class="site-header-react__extra-link"><svg class="site-header-react__nav-ellipsis" width="18px" height="4px" viewBox="0 0 18 4"><g stroke="none" stroke-width="1" fill="none" fill-rule="evenodd"><path d="M16,4 C14.8954305,4 14,3.1045695 14,2 C14,0.8954305 14.8954305,0 16,0 C17.1045695,0 18,0.8954305 18,2 C18,3.1045695 17.1045695,4 16,4 Z M9,4 C7.8954305,4 7,3.1045695 7,2 C7,0.8954305 7.8954305,0 9,0 C10.1045695,0 11,0.8954305 11,2 C11,3.1045695 10.1045695,4 9,4 Z M2,4 C0.8954305,4 0,3.1045695 0,2 C0,0.8954305 0.8954305,0 2,0 C3.1045695,0 4,0.8954305 4,2 C4,3.1045695 3.1045695,4 2,4 Z" fill="#FFFFFF"></path></g></svg></a></li></nav><div class="site-header-react__user"><span class="tooltip-container" data-tooltip="Your profile"><div class="site-header-react__user--logged-in"><ul><li class="site-header-react__user-avatar"><img src="./Using FastText models for robust embeddings _ Kaggle_files/360751-fb.jpg"></li></ul></div></span></div></div></div></div></div><script>var Kaggle=window.Kaggle||{};Kaggle.State=Kaggle.State||[];Kaggle.State.push({});performance && performance.mark && performance.mark("SiteHeaderContainer.componentCouldBootstrap");</script>
        </div>

    <div class="site-layout__main-content">
        


<div data-component-name="ScriptViewer" style="display: flex; flex-direction: column; flex: 1 0 auto;"><div data-reactroot="" class="script-viewer"><div class="script-viewer__header-background"></div><div class="script-viewer__container"><div class="kernel-header"><div class="pageheader"><div class="pageheader__container kernel-header__container"><div class="pageheader__top--safe"><div class="kernel-header__top"><a class="kernel-header__username false" href="https://www.kaggle.com/mschumacher">Max Schumacher</a><a class="kernel-header__title" href="https://www.kaggle.com/mschumacher/using-fasttext-models-for-robust-embeddings">Using FastText models for robust embeddings</a><div class="kernel-header__fork-info"></div><div class="kernel-header__thumbnails"><div class="pageheader__author--script"><a href="https://www.kaggle.com/mschumacher"><img src="./Using FastText models for robust embeddings _ Kaggle_files/48845-gr.jpg"></a><div class="pageheader__author-script-overlay"><div class="pageheader__overlay-text">Max Schumacher</div></div></div><div class="pageheader__thumbnail--script"><a href="https://www.kaggle.com/c/jigsaw-toxic-comment-classification-challenge"><img src="./Using FastText models for robust embeddings _ Kaggle_files/thumb76_76.png"></a><div class="pageheader__thumbnail-script-overlay"><div class="pageheader__overlay-text">Toxic Comment Classification Challenge</div></div></div></div><div class="kernel-header__upvote"><div class="vote-button__container vote-button__container--script"><div class="vote-button vote-button--enabled"><div class="vote-button__button vote-button__button--up"><span class="fa fa-caret-up"></span></div><div class="vote-button__button vote-button__button--up"><span class="vote-button__vote-count">46</span></div><div class="vote-button__button-placeholder"></div></div><div class="vote-button__show-voters"><a href="https://www.kaggle.com/mschumacher/using-fasttext-models-for-robust-embeddings">voters</a></div></div></div><img class="kernel-header__medal" src="./Using FastText models for robust embeddings _ Kaggle_files/silverL@1x.png"><div class="kernel-header__info"><span><time datetime="2018-02-12T13:15:44.943Z" title="2018-02-12T13:15:44.943Z"><!-- react-text: 37 -->last <!-- /react-text --><!-- react-text: 38 -->run<!-- /react-text --><!-- react-text: 39 --> <!-- /react-text --><span title="Mon Feb 12 2018 07:15:44 GMT-0600 (CST)">13 days ago</span></time></span><span><!-- react-text: 42 --> · <!-- /react-text --><!-- react-text: 43 -->Python notebook<!-- /react-text --><span><!-- react-text: 45 --> · <!-- /react-text --><!-- react-text: 46 -->3892<!-- /react-text --><!-- react-text: 47 --> views<!-- /react-text --></span></span><span><br><!-- react-text: 50 --> using data from <!-- /react-text --><a href="https://www.kaggle.com/c/jigsaw-toxic-comment-classification-challenge">Toxic Comment Classification Challenge</a></span><!-- react-text: 52 --> · <!-- /react-text --><span><div class="privacy-toggle"><div><span class="privacy-toggle__public-indicator"><!-- react-text: 57 --> <!-- /react-text --><span><i class="fa fa-eye"></i><!-- react-text: 60 --> Public<!-- /react-text --></span></span></div><div><!-- react-empty: 62 --></div></div></span></div></div></div><div><div class="pageheader__sticky pageheader__sticky--scrolling"><div class="pageheader__bottom pageheader__bottom"><div class="overflow-x__wrapper"><div class="overflow-x"><nav class="pageheader__nav pageheader__nav--script "><!-- react-empty: 69 --><div class="pageheader__nav-wrapper"><a href="https://www.kaggle.com/mschumacher/notebook" title="Notebook" class="pageheader__left-links pageheader__left-links--with-onclick pageheader__left-links--selected" id="pageheader-nav-item--notebook"><span><span>Notebook</span><!-- react-text: 74 --><!-- /react-text --></span></a><a href="https://www.kaggle.com/mschumacher/code" title="Code" class="pageheader__left-links pageheader__left-links--with-onclick" id="pageheader-nav-item--code"><span><span>Code</span><!-- react-text: 78 --><!-- /react-text --></span></a><a href="https://www.kaggle.com/mschumacher/data" title="Data" class="pageheader__left-links pageheader__left-links--with-onclick" id="pageheader-nav-item--data"><span><span>Data</span><span class="pageheader__link-count"><!-- react-text: 83 -->(<!-- /react-text --><!-- react-text: 84 -->1<!-- /react-text --><!-- react-text: 85 -->)<!-- /react-text --></span></span></a><a href="https://www.kaggle.com/mschumacher/comments" title="Comments" class="pageheader__left-links pageheader__left-links--with-onclick" id="pageheader-nav-item--comments"><span><span>Comments</span><span class="pageheader__link-count"><!-- react-text: 90 -->(<!-- /react-text --><!-- react-text: 91 -->24<!-- /react-text --><!-- react-text: 92 -->)<!-- /react-text --></span></span></a><a href="https://www.kaggle.com/mschumacher/log" title="Log" class="pageheader__left-links pageheader__left-links--with-onclick" id="pageheader-nav-item--log"><span><span>Log</span><!-- react-text: 96 --><!-- /react-text --></span></a><a href="https://www.kaggle.com/mschumacher/versions" title="Versions" class="pageheader__left-links pageheader__left-links--with-onclick" id="pageheader-nav-item--versions"><span><span>Versions</span><span class="pageheader__link-count"><!-- react-text: 101 -->(<!-- /react-text --><!-- react-text: 102 -->8<!-- /react-text --><!-- react-text: 103 -->)<!-- /react-text --></span></span></a><a href="https://www.kaggle.com/mschumacher/forks" title="Forks" class="pageheader__left-links pageheader__left-links--with-onclick" id="pageheader-nav-item--forks"><span><span>Forks</span><span class="pageheader__link-count"><!-- react-text: 108 -->(<!-- /react-text --><!-- react-text: 109 -->3<!-- /react-text --><!-- react-text: 110 -->)<!-- /react-text --></span></span></a><div class="pageheader__right-links-wrapper"></div></div></nav><a href="https://www.kaggle.com/jpmiller/kernels/notebooks/new?forkParentScriptVersionId=2456848" title="Fork Notebook" class="pageheader__calltoaction">Fork Notebook</a></div></div></div><div></div><div class="pageheader__transition"></div></div><!-- react-text: 1275 --><!-- /react-text --></div></div></div></div><div class="script-viewer__pane-container"><div><div class="script-notebook-pane" style="display: block;"><div class="content-box"><!-- react-text: 120 --><!-- /react-text --><div><div class="content-box__title-bar"><div class="content-box__title" style="line-height: 46px;">Notebook</div></div></div><div class="content-box__content-section"><div class="script-notebook-pane__container"><iframe id="nbIFrame" src="./Using FastText models for robust embeddings _ Kaggle_files/__results__.html" scrolling="no" style="height: 7088px; display: block;"></iframe><div class="script-notebook-pane__loading" style="display: none;"><div class="SpinnerContainer-rDhjZ dnInqT"><i class="fa fa-circle-o-notch fa-spin fa-2x"></i></div></div></div></div></div></div><div class="upvote-suggestion upvote-suggestion__kernel"><div class="upvote-suggestion__text"><div class="upvote-suggestion__main-text">Did you find this Kernel useful?</div><div class="upvote-suggestion__sub-text">Show your appreciation with an upvote</div></div><div class="upvote-suggestion__button"><div class="vote-button__container "><div class="vote-button vote-button--enabled"><div class="vote-button__button vote-button__button--up"><span class="fa fa-caret-up"></span></div><div class="vote-button__button vote-button__button--up"><span class="vote-button__vote-count">46</span></div><div class="vote-button__button-placeholder"></div></div></div></div><div class="upvote-suggestion__voters"><div class="upvote-suggestion__voter upvote-suggestion__voter-top"><span class="tooltip-container" data-tooltip="HardikChauhan" data-tooltip-size="small"><a href="https://www.kaggle.com/rquant" class="upvote-suggestion__voter-link"><img src="./Using FastText models for robust embeddings _ Kaggle_files/476223-fb.jpg" class="upvote-suggestion__voter-img"></a></span></div><div class="upvote-suggestion__voter upvote-suggestion__voter-top"><span class="tooltip-container" data-tooltip="Ceshine Lee" data-tooltip-size="small"><a href="https://www.kaggle.com/ceshine" class="upvote-suggestion__voter-link"><img src="./Using FastText models for robust embeddings _ Kaggle_files/101136-kg.jpg" class="upvote-suggestion__voter-img"></a></span></div><div class="upvote-suggestion__voter upvote-suggestion__voter-top"><span class="tooltip-container" data-tooltip="Dexter" data-tooltip-size="small"><a href="https://www.kaggle.com/lujunjie" class="upvote-suggestion__voter-link"><img src="./Using FastText models for robust embeddings _ Kaggle_files/default-thumb.png" class="upvote-suggestion__voter-img"></a></span></div><div class="upvote-suggestion__voter upvote-suggestion__voter-more"><span class="tooltip-container" data-tooltip="Master" data-tooltip-size="small"><a href="https://www.kaggle.com/nzabcd" class="upvote-suggestion__voter-link"><img src="./Using FastText models for robust embeddings _ Kaggle_files/default-thumb.png" class="upvote-suggestion__voter-img"></a></span></div><div class="upvote-suggestion__voter upvote-suggestion__voter-more"><span class="tooltip-container" data-tooltip="nkrnrnk" data-tooltip-size="small"><a href="https://www.kaggle.com/nickreinerink" class="upvote-suggestion__voter-link"><img src="./Using FastText models for robust embeddings _ Kaggle_files/339611-kg.jpeg" class="upvote-suggestion__voter-img"></a></span></div><div class="upvote-suggestion__voter upvote-suggestion__voter-more"><span class="tooltip-container" data-tooltip="chrain" data-tooltip-size="small"><a href="https://www.kaggle.com/chrain" class="upvote-suggestion__voter-link"><img src="./Using FastText models for robust embeddings _ Kaggle_files/default-thumb.png" class="upvote-suggestion__voter-img"></a></span></div><div class="upvote-suggestion__voter upvote-suggestion__voter-more"><span class="tooltip-container" data-tooltip="Nitish Kumar" data-tooltip-size="small"><a href="https://www.kaggle.com/nitishsingh41" class="upvote-suggestion__voter-link"><img src="./Using FastText models for robust embeddings _ Kaggle_files/default-thumb.png" class="upvote-suggestion__voter-img"></a></span></div><div class="upvote-suggestion__voter upvote-suggestion__voter-more"><span class="tooltip-container" data-tooltip="Thundo" data-tooltip-size="small"><a href="https://www.kaggle.com/thundo" class="upvote-suggestion__voter-link"><img src="./Using FastText models for robust embeddings _ Kaggle_files/1034690-gr.jpg" class="upvote-suggestion__voter-img"></a></span></div><div class="upvote-suggestion__voter upvote-suggestion__voter-more"><span class="tooltip-container" data-tooltip="Yuichi Fujikawa" data-tooltip-size="small"><a href="https://www.kaggle.com/fujiyuu75" class="upvote-suggestion__voter-link"><img src="./Using FastText models for robust embeddings _ Kaggle_files/704745-kg.jpg" class="upvote-suggestion__voter-img"></a></span></div><div class="upvote-suggestion__voter upvote-suggestion__voter-more"><span class="tooltip-container" data-tooltip="valentin_gut" data-tooltip-size="small"><a href="https://www.kaggle.com/valentingut" class="upvote-suggestion__voter-link"><img src="./Using FastText models for robust embeddings _ Kaggle_files/761206-kg.jpg" class="upvote-suggestion__voter-img"></a></span></div><div class="upvote-suggestion__voter upvote-suggestion__voter-other"><span class="tooltip-container" data-tooltip="Bojan Tunguz" data-tooltip-size="small"><a href="https://www.kaggle.com/tunguz" class="upvote-suggestion__voter-link"><img src="./Using FastText models for robust embeddings _ Kaggle_files/417337-fb.jpg" class="upvote-suggestion__voter-img"></a></span></div><div class="upvote-suggestion__voter upvote-suggestion__voter-other"><span class="tooltip-container" data-tooltip="Dmitry Senyushkin" data-tooltip-size="small"><a href="https://www.kaggle.com/albizar" class="upvote-suggestion__voter-link"><img src="./Using FastText models for robust embeddings _ Kaggle_files/1162710-kg.jpg" class="upvote-suggestion__voter-img"></a></span></div><div class="upvote-suggestion__voter upvote-suggestion__voter-other"><span class="tooltip-container" data-tooltip="Andrii Gogniat" data-tooltip-size="small"><a href="https://www.kaggle.com/gacoger" class="upvote-suggestion__voter-link"><img src="./Using FastText models for robust embeddings _ Kaggle_files/default-thumb.png" class="upvote-suggestion__voter-img"></a></span></div><div class="upvote-suggestion__voter upvote-suggestion__voter-other"><span class="tooltip-container" data-tooltip="pvdhn" data-tooltip-size="small"><a href="https://www.kaggle.com/pvdhna" class="upvote-suggestion__voter-link"><img src="./Using FastText models for robust embeddings _ Kaggle_files/default-thumb.png" class="upvote-suggestion__voter-img"></a></span></div><div class="upvote-suggestion__voter upvote-suggestion__voter-other"><span class="tooltip-container" data-tooltip="Ubique" data-tooltip-size="small"><a href="https://www.kaggle.com/ubique" class="upvote-suggestion__voter-link"><img src="./Using FastText models for robust embeddings _ Kaggle_files/109047-gp.jpg" class="upvote-suggestion__voter-img"></a></span></div></div></div><div class="comment-list"><!-- react-empty: 252 --><div class="comment-list__header"><span class="comment-list__title"><!-- react-text: 255 -->Comments <!-- /react-text --><span class="comment-list__title-count"><!-- react-text: 257 -->(<!-- /react-text --><!-- react-text: 258 -->24<!-- /react-text --><!-- react-text: 259 -->)<!-- /react-text --></span></span><span class="comment-list__spacer"></span><div class="comment-list__sort-pane-button"><div class="Select KaggleSelect Select--single has-value"><div class="Select-control"><span class="Select-multi-value-wrapper" id="react-select-2--value"><div class="Select-value"><span class="Select-value-label" role="option" aria-selected="true" id="react-select-2--value-item">All Comments</span></div><div role="combobox" aria-expanded="false" aria-owns="" aria-activedescendant="react-select-2--value" class="Select-input" tabindex="0" aria-readonly="false" style="border: 0px; width: 1px; display: inline-block;"></div></span><span class="Select-arrow-zone"><span class="Select-arrow"></span></span></div></div><span class="comment-list__sortby-label">Sort by</span><div class="Select KaggleSelect Select--single has-value"><div class="Select-control"><span class="Select-multi-value-wrapper" id="react-select-3--value"><div class="Select-value"><span class="Select-value-label" role="option" aria-selected="true" id="react-select-3--value-item">Hotness</span></div><div role="combobox" aria-expanded="false" aria-owns="" aria-activedescendant="react-select-3--value" class="Select-input" tabindex="0" aria-readonly="false" style="border: 0px; width: 1px; display: inline-block;"></div></span><span class="Select-arrow-zone"><span class="Select-arrow"></span></span></div></div></div><!-- react-empty: 279 --></div><div id="topic-reply"><div id="36591794.86715536"><!-- react-empty: 282 --><div class="comment-wrapper comment-wrapper--mini-form"><div class="discussion-comment__author"><a class="avatar" href="https://www.kaggle.com/jpmiller" style="width: 40px;"><img class="avatar__thumbnail" src="./Using FastText models for robust embeddings _ Kaggle_files/360751-fb.jpg" alt="JohnM" width="40" height="40" style="border-radius: 4px;"><img class="avatar__tier" src="./Using FastText models for robust embeddings _ Kaggle_files/avatier-expert@2x.png" width="40" style="margin-top: 2px;"></a></div><div class="discussion-comment"><div class="discussion-comment__body discussion-comment__body--mini discussion-comment__body--editing"><div class="markdown-editor markdown-editor__collapsed"><div tabindex="0" class="wmd-panel"><div id="wmd-button-bar-comment-36591794.86715536-edit" class="wmd-button-bar--disabled"><ul id="wmd-button-row-comment-36591794.86715536-edit" class="wmd-button-row"><li class="wmd-button" id="wmd-bold-button-comment-36591794.86715536-edit" title="Strong &lt;strong&gt; Ctrl+B" style="left: 0px;"><span style="background-position: 0px 0px;"></span></li><li class="wmd-button" id="wmd-italic-button-comment-36591794.86715536-edit" title="Emphasis &lt;em&gt; Ctrl+I" style="left: 25px;"><span style="background-position: -20px 0px;"></span></li><li class="wmd-spacer wmd-spacer1" id="wmd-spacer1-comment-36591794.86715536-edit"></li><li class="wmd-button" id="wmd-link-button-comment-36591794.86715536-edit" title="Hyperlink &lt;a&gt; Ctrl+L" style="left: 75px;"><span style="background-position: -40px 0px;"></span></li><li class="wmd-button" id="wmd-quote-button-comment-36591794.86715536-edit" title="Blockquote &lt;blockquote&gt; Ctrl+Q" style="left: 100px;"><span style="background-position: -60px 0px;"></span></li><li class="wmd-button" id="wmd-code-button-comment-36591794.86715536-edit" title="Code Sample &lt;pre&gt;&lt;code&gt; Ctrl+K" style="left: 125px;"><span style="background-position: -80px 0px;"></span></li><li class="wmd-button" id="wmd-image-button-comment-36591794.86715536-edit" title="Image &lt;img&gt; Ctrl+G" style="left: 150px;"><span style="background-position: -100px 0px;"></span></li><li class="wmd-spacer wmd-spacer2" id="wmd-spacer2-comment-36591794.86715536-edit"></li><li class="wmd-button" id="wmd-olist-button-comment-36591794.86715536-edit" title="Numbered List &lt;ol&gt; Ctrl+O" style="left: 200px;"><span style="background-position: -120px 0px;"></span></li><li class="wmd-button" id="wmd-ulist-button-comment-36591794.86715536-edit" title="Bulleted List &lt;ul&gt; Ctrl+U" style="left: 225px;"><span style="background-position: -140px 0px;"></span></li><li class="wmd-button" id="wmd-heading-button-comment-36591794.86715536-edit" title="Heading &lt;h1&gt;/&lt;h2&gt; Ctrl+H" style="left: 250px;"><span style="background-position: -160px 0px;"></span></li><li class="wmd-button" id="wmd-hr-button-comment-36591794.86715536-edit" title="Horizontal Rule &lt;hr&gt; Ctrl+R" style="left: 275px;"><span style="background-position: -180px 0px;"></span></li><li class="wmd-spacer wmd-spacer3" id="wmd-spacer3-comment-36591794.86715536-edit"></li><li class="wmd-button" id="wmd-undo-button-comment-36591794.86715536-edit" title="Undo - Ctrl+Z" style="left: 325px;"><span style="background-position: -200px -20px;"></span></li><li class="wmd-button" id="wmd-redo-button-comment-36591794.86715536-edit" title="Redo - Ctrl+Shift+Z" style="left: 350px;"><span style="background-position: -220px -20px;"></span></li></ul></div><textarea name="rawMarkdown" class="wmd-input" id="wmd-input-comment-36591794.86715536-edit" rows="3" placeholder="Click here to enter a comment…" style="height: 47.9886px;"></textarea></div></div></div></div></div><!-- react-empty: 294 --></div></div><div class="comment-list__comment-linking-spacer"></div><div id="279915"><!-- react-empty: 297 --><div class="comment-wrapper"><div class="discussion-comment__author"><a class="avatar" href="https://www.kaggle.com/chung1" style="width: 40px;"><img class="avatar__thumbnail" src="./Using FastText models for robust embeddings _ Kaggle_files/1622443-gr.jpg" alt="Jared Chung" width="40" height="40" style="border-radius: 4px;"><img class="avatar__tier" src="./Using FastText models for robust embeddings _ Kaggle_files/avatier-novice@2x.png" width="40" style="margin-top: 2px;"></a><img class="discussion-comment__medal" src="./Using FastText models for robust embeddings _ Kaggle_files/bronzeL@1x.png" title="bronze"></div><div class="discussion-comment discussion-comment--parent"><span class="discussion-comment__title"><span class="discussion-comment__title-author-link-wrapper"><a class="discussion-comment__title-author-link" href="https://www.kaggle.com/chung1" title="Jared Chung">Jared Chung</a></span><span class="discussion-comment__title-element">•</span><span class="discussion-comment__title-element">Posted on Version 7</span><span class="discussion-comment__title-element">•</span><span class="discussion-comment__title-element"><span title="Thu Feb 08 2018 17:49:10 GMT-0600 (CST)">16 days ago</span></span><span class="discussion-comment__title-element">•</span><a class="discussion-comment__title-element discussion-comment__title-element--link">Options</a><span class="discussion-comment__title-element">•</span><a class="discussion-comment__title-element discussion-comment__title-element--link">Reply</a><span class="discussion-comment__title-element--spacer"></span><div class="vote-button__container "><div class="vote-button vote-button--compact vote-button--enabled vote-button--has-downvote"><div class="vote-button__button vote-button__button--up"><span class="fa fa-angle-up"></span></div><div class="vote-button__button vote-button__button--up"><span class="vote-button__vote-count">5</span></div><div class="vote-button__button--down vote-button__button"><span class="fa fa-angle-down"></span></div></div></div></span><div class="discussion-comment__body"><div class="forum-message-content"><p>I suspect you would get some gains from using pertained vectors with more colloquialisms and idioms. You mention Twitter, which is a good start. But I suspect Urban Dictionary would be even more idiomatic and... toxic. Here's a dataset to train on <a href="https://www.kaggle.com/therohk/urban-dictionary-words-dataset">https://www.kaggle.com/therohk/urban-dictionary-words-dataset</a></p></div><span class=""></span><div class="file-list file-list--compact"></div><div class="file-list file-list--compact"></div></div><div class="discussion-comment__replies"><div id="280014"><!-- react-empty: 333 --><div class="comment-wrapper"><div class="discussion-comment__author"><a class="avatar" href="https://www.kaggle.com/zli117" style="width: 40px;"><img class="avatar__thumbnail" src="./Using FastText models for robust embeddings _ Kaggle_files/default-thumb.png" alt="NoSegfault" width="40" height="40" style="border-radius: 4px;"><img class="avatar__tier" src="./Using FastText models for robust embeddings _ Kaggle_files/avatier-novice@2x.png" width="40" style="margin-top: 2px;"></a><img class="discussion-comment__medal" src="./Using FastText models for robust embeddings _ Kaggle_files/bronzeL@1x.png" title="bronze"></div><div class="discussion-comment"><span class="discussion-comment__title"><span class="discussion-comment__title-author-link-wrapper"><a class="discussion-comment__title-author-link" href="https://www.kaggle.com/zli117" title="NoSegfault">NoSegfault</a></span><span class="discussion-comment__title-element">•</span><span class="discussion-comment__title-element">Posted on Version 7</span><span class="discussion-comment__title-element">•</span><span class="discussion-comment__title-element"><span title="Thu Feb 08 2018 23:02:54 GMT-0600 (CST)">16 days ago</span></span><span class="discussion-comment__title-element">•</span><a class="discussion-comment__title-element discussion-comment__title-element--link">Options</a><span class="discussion-comment__title-element">•</span><a class="discussion-comment__title-element discussion-comment__title-element--link">Reply</a><span class="discussion-comment__title-element--spacer"></span><div class="vote-button__container "><div class="vote-button vote-button--compact vote-button--enabled vote-button--has-downvote"><div class="vote-button__button vote-button__button--up"><span class="fa fa-angle-up"></span></div><div class="vote-button__button vote-button__button--up"><span class="vote-button__vote-count">1</span></div><div class="vote-button__button--down vote-button__button"><span class="fa fa-angle-down"></span></div></div></div></span><div class="discussion-comment__body"><div class="forum-message-content"><p>Maybe reddit dataset as well? <a href="https://www.kaggle.com/reddit/reddit-comments-may-2015/data">https://www.kaggle.com/reddit/reddit-comments-may-2015/data</a></p></div><span class=""></span><div class="file-list file-list--compact"></div><div class="file-list file-list--compact"></div></div></div></div><!-- react-empty: 367 --></div><div class="discussion-comment__linking-line"></div></div></div></div><!-- react-empty: 369 --></div><div class="comment-list__comment-linking-spacer"></div><div id="280599"><!-- react-empty: 372 --><div class="comment-wrapper"><div class="discussion-comment__author"><a class="avatar" href="https://www.kaggle.com/mjboos" style="width: 40px;"><img class="avatar__thumbnail" src="./Using FastText models for robust embeddings _ Kaggle_files/240422-kg.jpg" alt="Moritz Boos" width="40" height="40" style="border-radius: 4px;"><img class="avatar__tier" src="./Using FastText models for robust embeddings _ Kaggle_files/avatier-contributor@2x.png" width="40" style="margin-top: 2px;"></a><img class="discussion-comment__medal" src="./Using FastText models for robust embeddings _ Kaggle_files/bronzeL@1x.png" title="bronze"></div><div class="discussion-comment discussion-comment--parent"><span class="discussion-comment__title"><span class="discussion-comment__title-author-link-wrapper"><a class="discussion-comment__title-author-link" href="https://www.kaggle.com/mjboos" title="Moritz Boos">Moritz Boos</a></span><span class="discussion-comment__title-element">•</span><span class="discussion-comment__title-element">Posted on Version 7</span><span class="discussion-comment__title-element">•</span><span class="discussion-comment__title-element"><span title="Sat Feb 10 2018 06:09:21 GMT-0600 (CST)">15 days ago</span></span><span class="discussion-comment__title-element">•</span><a class="discussion-comment__title-element discussion-comment__title-element--link">Options</a><span class="discussion-comment__title-element">•</span><a class="discussion-comment__title-element discussion-comment__title-element--link">Reply</a><span class="discussion-comment__title-element--spacer"></span><div class="vote-button__container "><div class="vote-button vote-button--compact vote-button--enabled vote-button--has-downvote"><div class="vote-button__button vote-button__button--up"><span class="fa fa-angle-up"></span></div><div class="vote-button__button vote-button__button--up"><span class="vote-button__vote-count">1</span></div><div class="vote-button__button--down vote-button__button"><span class="fa fa-angle-down"></span></div></div></div></span><div class="discussion-comment__body"><div class="forum-message-content"><p>Nice approach.
I'm also using fasttext, and noticed their wikipedia model performs worse than the common crawl word vectors, even with the out-of-vocabulary word vectors that you can obtain from the wikipedia model.</p></div><span class=""></span><div class="file-list file-list--compact"></div><div class="file-list file-list--compact"></div></div><div class="discussion-comment__replies"><div id="281200"><!-- react-empty: 408 --><div class="comment-wrapper"><div class="discussion-comment__author"><a class="avatar" href="https://www.kaggle.com/mschumacher" style="width: 40px;"><img class="avatar__thumbnail" src="./Using FastText models for robust embeddings _ Kaggle_files/48845-gr.jpg" alt="Max Schumacher" width="40" height="40" style="border-radius: 4px;"><img class="avatar__tier" src="./Using FastText models for robust embeddings _ Kaggle_files/avatier-contributor@2x.png" width="40" style="margin-top: 2px;"></a></div><div class="discussion-comment"><span class="discussion-comment__title"><span class="discussion-comment__title-author-link-wrapper"><a class="discussion-comment__title-author-link discussion-comment__title-author-link--topic-author" href="https://www.kaggle.com/mschumacher" title="Max Schumacher">Max Schumacher</a></span><span class="discussion-comment__title-element">•</span><span class="discussion-comment__title-element">Posted on Version 7</span><span class="discussion-comment__title-element">•</span><span class="discussion-comment__title-element"><span title="Mon Feb 12 2018 01:30:28 GMT-0600 (CST)">13 days ago</span></span><span class="discussion-comment__title-element">•</span><a class="discussion-comment__title-element discussion-comment__title-element--link">Options</a><span class="discussion-comment__title-element">•</span><a class="discussion-comment__title-element discussion-comment__title-element--link">Reply</a><span class="discussion-comment__title-element--spacer"></span><div class="vote-button__container "><div class="vote-button vote-button--compact vote-button--enabled vote-button--has-downvote"><div class="vote-button__button vote-button__button--up"><span class="fa fa-angle-up"></span></div><div class="vote-button__button vote-button__button--up"><span class="vote-button__vote-count">0</span></div><div class="vote-button__button--down vote-button__button"><span class="fa fa-angle-down"></span></div></div></div></span><div class="discussion-comment__body"><div class="forum-message-content"><p>Oh really? That's interesting. I will try it out, thanks!</p></div><span class=""></span><div class="file-list file-list--compact"></div><div class="file-list file-list--compact"></div></div></div></div><!-- react-empty: 441 --></div><div class="discussion-comment__linking-line"></div></div></div></div><!-- react-empty: 443 --></div><div class="comment-list__comment-linking-spacer"></div><div id="279157"><!-- react-empty: 446 --><div class="comment-wrapper"><div class="discussion-comment__author"><a class="avatar" href="https://www.kaggle.com/mrugankakarte" style="width: 40px;"><img class="avatar__thumbnail" src="./Using FastText models for robust embeddings _ Kaggle_files/632012-kg.jpg" alt="Mrugank Akarte" width="40" height="40" style="border-radius: 4px;"><img class="avatar__tier" src="./Using FastText models for robust embeddings _ Kaggle_files/avatier-contributor@2x.png" width="40" style="margin-top: 2px;"></a></div><div class="discussion-comment discussion-comment--parent"><span class="discussion-comment__title"><span class="discussion-comment__title-author-link-wrapper"><a class="discussion-comment__title-author-link" href="https://www.kaggle.com/mrugankakarte" title="Mrugank Akarte">Mrugank Akarte</a></span><span class="discussion-comment__title-element">•</span><span class="discussion-comment__title-element">Posted on Version 3</span><span class="discussion-comment__title-element">•</span><span class="discussion-comment__title-element"><span title="Wed Feb 07 2018 07:35:14 GMT-0600 (CST)">18 days ago</span></span><span class="discussion-comment__title-element">•</span><a class="discussion-comment__title-element discussion-comment__title-element--link">Options</a><span class="discussion-comment__title-element">•</span><a class="discussion-comment__title-element discussion-comment__title-element--link">Reply</a><span class="discussion-comment__title-element--spacer"></span><div class="vote-button__container "><div class="vote-button vote-button--compact vote-button--enabled vote-button--has-downvote"><div class="vote-button__button vote-button__button--up"><span class="fa fa-angle-up"></span></div><div class="vote-button__button vote-button__button--up"><span class="vote-button__vote-count">0</span></div><div class="vote-button__button--down vote-button__button"><span class="fa fa-angle-down"></span></div></div></div></span><div class="discussion-comment__body"><div class="forum-message-content"><p>Thanks a lot!!! I was trying to train a fasttext model on our training set and predicting using that model and the results were not good. Just out of curiosity, are there any models available which can be loaded into a 8GB RAM laptop? Or downloading .vec file and create embedding matrix is the only other way?</p></div><span class=""></span><div class="file-list file-list--compact"></div><div class="file-list file-list--compact"></div></div><div class="discussion-comment__replies"><div id="279168"><!-- react-empty: 481 --><div class="comment-wrapper"><div class="discussion-comment__author"><a class="avatar" href="https://www.kaggle.com/mschumacher" style="width: 40px;"><img class="avatar__thumbnail" src="./Using FastText models for robust embeddings _ Kaggle_files/48845-gr.jpg" alt="Max Schumacher" width="40" height="40" style="border-radius: 4px;"><img class="avatar__tier" src="./Using FastText models for robust embeddings _ Kaggle_files/avatier-contributor@2x.png" width="40" style="margin-top: 2px;"></a><img class="discussion-comment__medal" src="./Using FastText models for robust embeddings _ Kaggle_files/bronzeL@1x.png" title="bronze"></div><div class="discussion-comment"><span class="discussion-comment__title"><span class="discussion-comment__title-author-link-wrapper"><a class="discussion-comment__title-author-link discussion-comment__title-author-link--topic-author" href="https://www.kaggle.com/mschumacher" title="Max Schumacher">Max Schumacher</a></span><span class="discussion-comment__title-element">•</span><span class="discussion-comment__title-element">Posted on Version 3</span><span class="discussion-comment__title-element">•</span><span class="discussion-comment__title-element"><span title="Wed Feb 07 2018 07:57:28 GMT-0600 (CST)">18 days ago</span></span><span class="discussion-comment__title-element">•</span><a class="discussion-comment__title-element discussion-comment__title-element--link">Options</a><span class="discussion-comment__title-element">•</span><a class="discussion-comment__title-element discussion-comment__title-element--link">Reply</a><span class="discussion-comment__title-element--spacer"></span><div class="vote-button__container "><div class="vote-button vote-button--compact vote-button--enabled vote-button--has-downvote"><div class="vote-button__button vote-button__button--up"><span class="fa fa-angle-up"></span></div><div class="vote-button__button vote-button__button--up"><span class="vote-button__vote-count">2</span></div><div class="vote-button__button--down vote-button__button"><span class="fa fa-angle-down"></span></div></div></div></span><div class="discussion-comment__body"><div class="forum-message-content"><p>I tried training the model directly on the data, but I don't think it's enough text to really learn something feasible. I also tried lower-dimensional models, but those were significantly weaker.</p>

<p>What you can do though, assuming you're running Unix, have a fast SSD drive and some free space: Allocate some swap space on the hard drive as extra memory. It will be slower than RAM but that way at least you can load the model, preprocess the data and then store it in another file to use for training. I've done it before and it was fast enough to work with. Just google it, there are tons of guides.</p></div><span class=""></span><div class="file-list file-list--compact"></div><div class="file-list file-list--compact"></div></div></div></div><!-- react-empty: 515 --></div><div class="discussion-comment__linking-line"></div><div id="279170"><!-- react-empty: 518 --><div class="comment-wrapper"><div class="discussion-comment__author"><a class="avatar" href="https://www.kaggle.com/mrugankakarte" style="width: 40px;"><img class="avatar__thumbnail" src="./Using FastText models for robust embeddings _ Kaggle_files/632012-kg.jpg" alt="Mrugank Akarte" width="40" height="40" style="border-radius: 4px;"><img class="avatar__tier" src="./Using FastText models for robust embeddings _ Kaggle_files/avatier-contributor@2x.png" width="40" style="margin-top: 2px;"></a></div><div class="discussion-comment"><span class="discussion-comment__title"><span class="discussion-comment__title-author-link-wrapper"><a class="discussion-comment__title-author-link" href="https://www.kaggle.com/mrugankakarte" title="Mrugank Akarte">Mrugank Akarte</a></span><span class="discussion-comment__title-element">•</span><span class="discussion-comment__title-element">Posted on Version 3</span><span class="discussion-comment__title-element">•</span><span class="discussion-comment__title-element"><span title="Wed Feb 07 2018 08:01:30 GMT-0600 (CST)">18 days ago</span></span><span class="discussion-comment__title-element">•</span><a class="discussion-comment__title-element discussion-comment__title-element--link">Options</a><span class="discussion-comment__title-element">•</span><a class="discussion-comment__title-element discussion-comment__title-element--link">Reply</a><span class="discussion-comment__title-element--spacer"></span><div class="vote-button__container "><div class="vote-button vote-button--compact vote-button--enabled vote-button--has-downvote"><div class="vote-button__button vote-button__button--up"><span class="fa fa-angle-up"></span></div><div class="vote-button__button vote-button__button--up"><span class="vote-button__vote-count">0</span></div><div class="vote-button__button--down vote-button__button"><span class="fa fa-angle-down"></span></div></div></div></span><div class="discussion-comment__body"><div class="forum-message-content"><p>Thanks for advice.. I will take a look at it. I am using Windows 10 and R for modelling. :)</p></div><span class=""></span><div class="file-list file-list--compact"></div><div class="file-list file-list--compact"></div></div></div></div><!-- react-empty: 551 --></div><div class="discussion-comment__linking-line"></div><div id="279270"><!-- react-empty: 554 --><div class="comment-wrapper"><div class="discussion-comment__author"><a class="avatar" href="https://www.kaggle.com/christofhenkel" style="width: 40px;"><img class="avatar__thumbnail" src="./Using FastText models for robust embeddings _ Kaggle_files/1424766-kg.png" alt="Dieter" width="40" height="40" style="border-radius: 4px;"><img class="avatar__tier" src="./Using FastText models for robust embeddings _ Kaggle_files/avatier-contributor@2x.png" width="40" style="margin-top: 2px;"></a></div><div class="discussion-comment"><span class="discussion-comment__title"><span class="discussion-comment__title-author-link-wrapper"><a class="discussion-comment__title-author-link" href="https://www.kaggle.com/christofhenkel" title="Dieter">Dieter</a></span><span class="discussion-comment__title-element">•</span><span class="discussion-comment__title-element">Posted on Version 3</span><span class="discussion-comment__title-element">•</span><span class="discussion-comment__title-element"><span title="Wed Feb 07 2018 11:30:42 GMT-0600 (CST)">17 days ago</span></span><span class="discussion-comment__title-element">•</span><a class="discussion-comment__title-element discussion-comment__title-element--link">Options</a><span class="discussion-comment__title-element">•</span><a class="discussion-comment__title-element discussion-comment__title-element--link">Reply</a><span class="discussion-comment__title-element--spacer"></span><div class="vote-button__container "><div class="vote-button vote-button--compact vote-button--enabled vote-button--has-downvote"><div class="vote-button__button vote-button__button--up"><span class="fa fa-angle-up"></span></div><div class="vote-button__button vote-button__button--up"><span class="vote-button__vote-count">0</span></div><div class="vote-button__button--down vote-button__button"><span class="fa fa-angle-down"></span></div></div></div></span><div class="discussion-comment__body"><div class="forum-message-content"><p>@Max You saved my day.</p></div><span class=""></span><div class="file-list file-list--compact"></div><div class="file-list file-list--compact"></div></div></div></div><!-- react-empty: 587 --></div><div class="discussion-comment__linking-line"></div><div id="279308"><!-- react-empty: 590 --><div class="comment-wrapper"><div class="discussion-comment__author"><a class="avatar" href="https://www.kaggle.com/mschumacher" style="width: 40px;"><img class="avatar__thumbnail" src="./Using FastText models for robust embeddings _ Kaggle_files/48845-gr.jpg" alt="Max Schumacher" width="40" height="40" style="border-radius: 4px;"><img class="avatar__tier" src="./Using FastText models for robust embeddings _ Kaggle_files/avatier-contributor@2x.png" width="40" style="margin-top: 2px;"></a></div><div class="discussion-comment"><span class="discussion-comment__title"><span class="discussion-comment__title-author-link-wrapper"><a class="discussion-comment__title-author-link discussion-comment__title-author-link--topic-author" href="https://www.kaggle.com/mschumacher" title="Max Schumacher">Max Schumacher</a></span><span class="discussion-comment__title-element">•</span><span class="discussion-comment__title-element">Posted on Version 3</span><span class="discussion-comment__title-element">•</span><span class="discussion-comment__title-element"><span title="Wed Feb 07 2018 13:01:31 GMT-0600 (CST)">17 days ago</span></span><span class="discussion-comment__title-element">•</span><a class="discussion-comment__title-element discussion-comment__title-element--link">Options</a><span class="discussion-comment__title-element">•</span><a class="discussion-comment__title-element discussion-comment__title-element--link">Reply</a><span class="discussion-comment__title-element--spacer"></span><div class="vote-button__container "><div class="vote-button vote-button--compact vote-button--enabled vote-button--has-downvote"><div class="vote-button__button vote-button__button--up"><span class="fa fa-angle-up"></span></div><div class="vote-button__button vote-button__button--up"><span class="vote-button__vote-count">0</span></div><div class="vote-button__button--down vote-button__button"><span class="fa fa-angle-down"></span></div></div></div></span><div class="discussion-comment__body"><div class="forum-message-content"><p>Hey Dieter! Keine Ursache und Grüße aus München :)</p></div><span class=""></span><div class="file-list file-list--compact"></div><div class="file-list file-list--compact"></div></div></div></div><!-- react-empty: 623 --></div><div class="discussion-comment__linking-line"></div><div id="279731"><!-- react-empty: 626 --><div class="comment-wrapper"><div class="discussion-comment__author"><a class="avatar" href="https://www.kaggle.com/ethranes" style="width: 40px;"><img class="avatar__thumbnail" src="./Using FastText models for robust embeddings _ Kaggle_files/1605360-fb.jpg" alt="Nathan Wilcox" width="40" height="40" style="border-radius: 4px;"><img class="avatar__tier" src="./Using FastText models for robust embeddings _ Kaggle_files/avatier-contributor@2x.png" width="40" style="margin-top: 2px;"></a></div><div class="discussion-comment"><span class="discussion-comment__title"><span class="discussion-comment__title-author-link-wrapper"><a class="discussion-comment__title-author-link" href="https://www.kaggle.com/ethranes" title="Nathan Wilcox">Nathan Wilcox</a></span><span class="discussion-comment__title-element">•</span><span class="discussion-comment__title-element">Posted on Version 7</span><span class="discussion-comment__title-element">•</span><span class="discussion-comment__title-element"><span title="Thu Feb 08 2018 10:04:56 GMT-0600 (CST)">17 days ago</span></span><span class="discussion-comment__title-element">•</span><a class="discussion-comment__title-element discussion-comment__title-element--link">Options</a><span class="discussion-comment__title-element">•</span><a class="discussion-comment__title-element discussion-comment__title-element--link">Reply</a><span class="discussion-comment__title-element--spacer"></span><div class="vote-button__container "><div class="vote-button vote-button--compact vote-button--enabled vote-button--has-downvote"><div class="vote-button__button vote-button__button--up"><span class="fa fa-angle-up"></span></div><div class="vote-button__button vote-button__button--up"><span class="vote-button__vote-count">0</span></div><div class="vote-button__button--down vote-button__button"><span class="fa fa-angle-down"></span></div></div></div></span><div class="discussion-comment__body"><div class="forum-message-content"><p>great</p></div><span class=""></span><div class="file-list file-list--compact"></div><div class="file-list file-list--compact"></div></div></div></div><!-- react-empty: 659 --></div><div class="discussion-comment__linking-line"></div></div></div></div><!-- react-empty: 661 --></div><div class="comment-list__comment-linking-spacer"></div><div id="279567"><!-- react-empty: 664 --><div class="comment-wrapper"><div class="discussion-comment__author"><a class="avatar" href="https://www.kaggle.com/liujilong" style="width: 40px;"><img class="avatar__thumbnail" src="./Using FastText models for robust embeddings _ Kaggle_files/default-thumb.png" alt="Liu Jilong(刘继龙)" width="40" height="40" style="border-radius: 4px;"><img class="avatar__tier" src="./Using FastText models for robust embeddings _ Kaggle_files/avatier-contributor@2x.png" width="40" style="margin-top: 2px;"></a></div><div class="discussion-comment discussion-comment--parent"><span class="discussion-comment__title"><span class="discussion-comment__title-author-link-wrapper"><a class="discussion-comment__title-author-link" href="https://www.kaggle.com/liujilong" title="Liu Jilong(刘继龙)">Liu Jilong(刘继龙)</a></span><span class="discussion-comment__title-element">•</span><span class="discussion-comment__title-element">Posted on Version 3</span><span class="discussion-comment__title-element">•</span><span class="discussion-comment__title-element"><span title="Thu Feb 08 2018 03:11:27 GMT-0600 (CST)">17 days ago</span></span><span class="discussion-comment__title-element">•</span><a class="discussion-comment__title-element discussion-comment__title-element--link">Options</a><span class="discussion-comment__title-element">•</span><a class="discussion-comment__title-element discussion-comment__title-element--link">Reply</a><span class="discussion-comment__title-element--spacer"></span><div class="vote-button__container "><div class="vote-button vote-button--compact vote-button--enabled vote-button--has-downvote"><div class="vote-button__button vote-button__button--up"><span class="fa fa-angle-up"></span></div><div class="vote-button__button vote-button__button--up"><span class="vote-button__vote-count">0</span></div><div class="vote-button__button--down vote-button__button"><span class="fa fa-angle-down"></span></div></div></div></span><div class="discussion-comment__body"><div class="forum-message-content"><p>When I run the script in p2.xlarge, which has memory of 62G, MemoryError happened.</p>

<p><code>
x = np.zeros((len(df), window_length, n_features), dtype='float32')
</code></p>

<p>The size of <code>x</code> is 150000(df length) * 200(sentence len) * 300(embed dim) * 4(4 byte float32) = 36G</p>

<p>The total memeory size of x_train and x_test is 72G.</p>

<p>Any suggestions?</p></div><span class=""></span><div class="file-list file-list--compact"></div><div class="file-list file-list--compact"></div></div><div class="discussion-comment__replies"><div id="279598"><!-- react-empty: 699 --><div class="comment-wrapper"><div class="discussion-comment__author"><a class="avatar" href="https://www.kaggle.com/mschumacher" style="width: 40px;"><img class="avatar__thumbnail" src="./Using FastText models for robust embeddings _ Kaggle_files/48845-gr.jpg" alt="Max Schumacher" width="40" height="40" style="border-radius: 4px;"><img class="avatar__tier" src="./Using FastText models for robust embeddings _ Kaggle_files/avatier-contributor@2x.png" width="40" style="margin-top: 2px;"></a><img class="discussion-comment__medal" src="./Using FastText models for robust embeddings _ Kaggle_files/bronzeL@1x.png" title="bronze"></div><div class="discussion-comment"><span class="discussion-comment__title"><span class="discussion-comment__title-author-link-wrapper"><a class="discussion-comment__title-author-link discussion-comment__title-author-link--topic-author" href="https://www.kaggle.com/mschumacher" title="Max Schumacher">Max Schumacher</a></span><span class="discussion-comment__title-element">•</span><span class="discussion-comment__title-element">Posted on Version 3</span><span class="discussion-comment__title-element">•</span><span class="discussion-comment__title-element"><span title="Thu Feb 08 2018 04:22:11 GMT-0600 (CST)">17 days ago</span></span><span class="discussion-comment__title-element">•</span><a class="discussion-comment__title-element discussion-comment__title-element--link">Options</a><span class="discussion-comment__title-element">•</span><a class="discussion-comment__title-element discussion-comment__title-element--link">Reply</a><span class="discussion-comment__title-element--spacer"></span><div class="vote-button__container "><div class="vote-button vote-button--compact vote-button--enabled vote-button--has-downvote"><div class="vote-button__button vote-button__button--up"><span class="fa fa-angle-up"></span></div><div class="vote-button__button vote-button__button--up"><span class="vote-button__vote-count">1</span></div><div class="vote-button__button--down vote-button__button"><span class="fa fa-angle-down"></span></div></div></div></span><div class="discussion-comment__body"><div class="forum-message-content"><p>Hmm interesting... Ok then I have two suggestions, I would do both for good measure:</p>

<ol>
<li>Add 10-20 GB swap space to your machine: <a href="https://stackoverflow.com/questions/17173972/how-do-you-add-swap-to-an-ec2-instance">https://stackoverflow.com/questions/17173972/how-do-you-add-swap-to-an-ec2-instance</a></li>
<li>Before training, only build the training set. After training, remove it from memory and then build the test set. You can remove it from memory like this:</li>
</ol>

<p><code>import gc</code></p>

<p><code>del train</code></p>

<p><code>gc.collect()</code></p>

<p>Sorry, I guess it worked on mine because I'm swapping.</p>

<p><strong>EDIT:</strong> There's also a third way, which I would recommend: Use Keras' <code>fit_generator</code> so you never have to have the whole dataset in memory.</p></div><span class=""></span><div class="file-list file-list--compact"></div><div class="file-list file-list--compact"></div></div></div></div><!-- react-empty: 733 --></div><div class="discussion-comment__linking-line"></div><div id="279635"><!-- react-empty: 736 --><div class="comment-wrapper"><div class="discussion-comment__author"><a class="avatar" href="https://www.kaggle.com/liujilong" style="width: 40px;"><img class="avatar__thumbnail" src="./Using FastText models for robust embeddings _ Kaggle_files/default-thumb.png" alt="Liu Jilong(刘继龙)" width="40" height="40" style="border-radius: 4px;"><img class="avatar__tier" src="./Using FastText models for robust embeddings _ Kaggle_files/avatier-contributor@2x.png" width="40" style="margin-top: 2px;"></a></div><div class="discussion-comment"><span class="discussion-comment__title"><span class="discussion-comment__title-author-link-wrapper"><a class="discussion-comment__title-author-link" href="https://www.kaggle.com/liujilong" title="Liu Jilong(刘继龙)">Liu Jilong(刘继龙)</a></span><span class="discussion-comment__title-element">•</span><span class="discussion-comment__title-element">Posted on Version 3</span><span class="discussion-comment__title-element">•</span><span class="discussion-comment__title-element"><span title="Thu Feb 08 2018 06:11:22 GMT-0600 (CST)">17 days ago</span></span><span class="discussion-comment__title-element">•</span><a class="discussion-comment__title-element discussion-comment__title-element--link">Options</a><span class="discussion-comment__title-element">•</span><a class="discussion-comment__title-element discussion-comment__title-element--link">Reply</a><span class="discussion-comment__title-element--spacer"></span><div class="vote-button__container "><div class="vote-button vote-button--compact vote-button--enabled vote-button--has-downvote"><div class="vote-button__button vote-button__button--up"><span class="fa fa-angle-up"></span></div><div class="vote-button__button vote-button__button--up"><span class="vote-button__vote-count">0</span></div><div class="vote-button__button--down vote-button__button"><span class="fa fa-angle-down"></span></div></div></div></span><div class="discussion-comment__body"><div class="forum-message-content"><p>Suggestions seems effective. I will try <code>fit_generator</code>.</p>

<p>Since fasttext can guess unseen words' embedding vector. One can build an embed matrix for all words, and use the common embedding lookup.</p>

<p>Does this makes any differences with your approach in the kernel? </p>

<p>In my opinion, that is just time-space trading.</p></div><span class=""></span><div class="file-list file-list--compact"></div><div class="file-list file-list--compact"></div></div></div></div><!-- react-empty: 769 --></div><div class="discussion-comment__linking-line"></div><div id="279644"><!-- react-empty: 772 --><div class="comment-wrapper"><div class="discussion-comment__author"><a class="avatar" href="https://www.kaggle.com/mschumacher" style="width: 40px;"><img class="avatar__thumbnail" src="./Using FastText models for robust embeddings _ Kaggle_files/48845-gr.jpg" alt="Max Schumacher" width="40" height="40" style="border-radius: 4px;"><img class="avatar__tier" src="./Using FastText models for robust embeddings _ Kaggle_files/avatier-contributor@2x.png" width="40" style="margin-top: 2px;"></a></div><div class="discussion-comment"><span class="discussion-comment__title"><span class="discussion-comment__title-author-link-wrapper"><a class="discussion-comment__title-author-link discussion-comment__title-author-link--topic-author" href="https://www.kaggle.com/mschumacher" title="Max Schumacher">Max Schumacher</a></span><span class="discussion-comment__title-element">•</span><span class="discussion-comment__title-element">Posted on Version 6</span><span class="discussion-comment__title-element">•</span><span class="discussion-comment__title-element"><span title="Thu Feb 08 2018 06:57:25 GMT-0600 (CST)">17 days ago</span></span><span class="discussion-comment__title-element">•</span><a class="discussion-comment__title-element discussion-comment__title-element--link">Options</a><span class="discussion-comment__title-element">•</span><a class="discussion-comment__title-element discussion-comment__title-element--link">Reply</a><span class="discussion-comment__title-element--spacer"></span><div class="vote-button__container "><div class="vote-button vote-button--compact vote-button--enabled vote-button--has-downvote"><div class="vote-button__button vote-button__button--up"><span class="fa fa-angle-up"></span></div><div class="vote-button__button vote-button__button--up"><span class="vote-button__vote-count">0</span></div><div class="vote-button__button--down vote-button__button"><span class="fa fa-angle-down"></span></div></div></div></span><div class="discussion-comment__body"><div class="forum-message-content"><p>Hey Jilong, I guess you could precompute the vectors for all words that appear in both training and test set and then use those. Is that what you mean? That way, you won't be able to add some neat features like synthetic typos, though.</p>

<p>I added a section at the bottom about how to build a generator for this. Thanks for pointing out the memory issue!</p></div><span class=""></span><div class="file-list file-list--compact"></div><div class="file-list file-list--compact"></div></div></div></div><!-- react-empty: 805 --></div><div class="discussion-comment__linking-line"></div></div></div></div><!-- react-empty: 807 --></div><div class="comment-list__comment-linking-spacer"></div><div id="279801"><!-- react-empty: 810 --><div class="comment-wrapper"><div class="discussion-comment__author"><a class="avatar" href="https://www.kaggle.com/mrugankakarte" style="width: 40px;"><img class="avatar__thumbnail" src="./Using FastText models for robust embeddings _ Kaggle_files/632012-kg.jpg" alt="Mrugank Akarte" width="40" height="40" style="border-radius: 4px;"><img class="avatar__tier" src="./Using FastText models for robust embeddings _ Kaggle_files/avatier-contributor@2x.png" width="40" style="margin-top: 2px;"></a></div><div class="discussion-comment discussion-comment--parent"><span class="discussion-comment__title"><span class="discussion-comment__title-author-link-wrapper"><a class="discussion-comment__title-author-link" href="https://www.kaggle.com/mrugankakarte" title="Mrugank Akarte">Mrugank Akarte</a></span><span class="discussion-comment__title-element">•</span><span class="discussion-comment__title-element">Posted on Version 7</span><span class="discussion-comment__title-element">•</span><span class="discussion-comment__title-element"><span title="Thu Feb 08 2018 12:15:23 GMT-0600 (CST)">16 days ago</span></span><span class="discussion-comment__title-element">•</span><a class="discussion-comment__title-element discussion-comment__title-element--link">Options</a><span class="discussion-comment__title-element">•</span><a class="discussion-comment__title-element discussion-comment__title-element--link">Reply</a><span class="discussion-comment__title-element--spacer"></span><div class="vote-button__container "><div class="vote-button vote-button--compact vote-button--enabled vote-button--has-downvote"><div class="vote-button__button vote-button__button--up"><span class="fa fa-angle-up"></span></div><div class="vote-button__button vote-button__button--up"><span class="vote-button__vote-count">0</span></div><div class="vote-button__button--down vote-button__button"><span class="fa fa-angle-down"></span></div></div></div></span><div class="discussion-comment__body"><div class="forum-message-content"><p>Are .vec files read in same manner as .bin?</p></div><span class=""></span><div class="file-list file-list--compact"></div><div class="file-list file-list--compact"></div></div><div class="discussion-comment__replies"><div id="279817"><!-- react-empty: 845 --><div class="comment-wrapper"><div class="discussion-comment__author"><a class="avatar" href="https://www.kaggle.com/mschumacher" style="width: 40px;"><img class="avatar__thumbnail" src="./Using FastText models for robust embeddings _ Kaggle_files/48845-gr.jpg" alt="Max Schumacher" width="40" height="40" style="border-radius: 4px;"><img class="avatar__tier" src="./Using FastText models for robust embeddings _ Kaggle_files/avatier-contributor@2x.png" width="40" style="margin-top: 2px;"></a></div><div class="discussion-comment"><span class="discussion-comment__title"><span class="discussion-comment__title-author-link-wrapper"><a class="discussion-comment__title-author-link discussion-comment__title-author-link--topic-author" href="https://www.kaggle.com/mschumacher" title="Max Schumacher">Max Schumacher</a></span><span class="discussion-comment__title-element">•</span><span class="discussion-comment__title-element">Posted on Version 7</span><span class="discussion-comment__title-element">•</span><span class="discussion-comment__title-element"><span title="Thu Feb 08 2018 13:03:27 GMT-0600 (CST)">16 days ago</span></span><span class="discussion-comment__title-element">•</span><a class="discussion-comment__title-element discussion-comment__title-element--link">Options</a><span class="discussion-comment__title-element">•</span><a class="discussion-comment__title-element discussion-comment__title-element--link">Reply</a><span class="discussion-comment__title-element--spacer"></span><div class="vote-button__container "><div class="vote-button vote-button--compact vote-button--enabled vote-button--has-downvote"><div class="vote-button__button vote-button__button--up"><span class="fa fa-angle-up"></span></div><div class="vote-button__button vote-button__button--up"><span class="vote-button__vote-count">0</span></div><div class="vote-button__button--down vote-button__button"><span class="fa fa-angle-down"></span></div></div></div></span><div class="discussion-comment__body"><div class="forum-message-content"><p>No, those are just a list of word vectors I believe. For this application, you can ignore them.</p></div><span class=""></span><div class="file-list file-list--compact"></div><div class="file-list file-list--compact"></div></div></div></div><!-- react-empty: 878 --></div><div class="discussion-comment__linking-line"></div><div id="280020"><!-- react-empty: 881 --><div class="comment-wrapper"><div class="discussion-comment__author"><a class="avatar" href="https://www.kaggle.com/mrugankakarte" style="width: 40px;"><img class="avatar__thumbnail" src="./Using FastText models for robust embeddings _ Kaggle_files/632012-kg.jpg" alt="Mrugank Akarte" width="40" height="40" style="border-radius: 4px;"><img class="avatar__tier" src="./Using FastText models for robust embeddings _ Kaggle_files/avatier-contributor@2x.png" width="40" style="margin-top: 2px;"></a></div><div class="discussion-comment"><span class="discussion-comment__title"><span class="discussion-comment__title-author-link-wrapper"><a class="discussion-comment__title-author-link" href="https://www.kaggle.com/mrugankakarte" title="Mrugank Akarte">Mrugank Akarte</a></span><span class="discussion-comment__title-element">•</span><span class="discussion-comment__title-element">Posted on Version 7</span><span class="discussion-comment__title-element">•</span><span class="discussion-comment__title-element"><span title="Thu Feb 08 2018 23:19:00 GMT-0600 (CST)">16 days ago</span></span><span class="discussion-comment__title-element">•</span><a class="discussion-comment__title-element discussion-comment__title-element--link">Options</a><span class="discussion-comment__title-element">•</span><a class="discussion-comment__title-element discussion-comment__title-element--link">Reply</a><span class="discussion-comment__title-element--spacer"></span><div class="vote-button__container "><div class="vote-button vote-button--compact vote-button--enabled vote-button--has-downvote"><div class="vote-button__button vote-button__button--up"><span class="fa fa-angle-up"></span></div><div class="vote-button__button vote-button__button--up"><span class="vote-button__vote-count">0</span></div><div class="vote-button__button--down vote-button__button"><span class="fa fa-angle-down"></span></div></div></div></span><div class="discussion-comment__body"><div class="forum-message-content"><p>Then how are people using crawl300d word vectors for embedding any idea?</p></div><span class=""></span><div class="file-list file-list--compact"></div><div class="file-list file-list--compact"></div></div></div></div><!-- react-empty: 914 --></div><div class="discussion-comment__linking-line"></div><div id="280050"><!-- react-empty: 917 --><div class="comment-wrapper"><div class="discussion-comment__author"><a class="avatar" href="https://www.kaggle.com/mschumacher" style="width: 40px;"><img class="avatar__thumbnail" src="./Using FastText models for robust embeddings _ Kaggle_files/48845-gr.jpg" alt="Max Schumacher" width="40" height="40" style="border-radius: 4px;"><img class="avatar__tier" src="./Using FastText models for robust embeddings _ Kaggle_files/avatier-contributor@2x.png" width="40" style="margin-top: 2px;"></a></div><div class="discussion-comment"><span class="discussion-comment__title"><span class="discussion-comment__title-author-link-wrapper"><a class="discussion-comment__title-author-link discussion-comment__title-author-link--topic-author" href="https://www.kaggle.com/mschumacher" title="Max Schumacher">Max Schumacher</a></span><span class="discussion-comment__title-element">•</span><span class="discussion-comment__title-element">Posted on Version 7</span><span class="discussion-comment__title-element">•</span><span class="discussion-comment__title-element"><span title="Fri Feb 09 2018 01:15:32 GMT-0600 (CST)">16 days ago</span></span><span class="discussion-comment__title-element">•</span><a class="discussion-comment__title-element discussion-comment__title-element--link">Options</a><span class="discussion-comment__title-element">•</span><a class="discussion-comment__title-element discussion-comment__title-element--link">Reply</a><span class="discussion-comment__title-element--spacer"></span><div class="vote-button__container "><div class="vote-button vote-button--compact vote-button--enabled vote-button--has-downvote"><div class="vote-button__button vote-button__button--up"><span class="fa fa-angle-up"></span></div><div class="vote-button__button vote-button__button--up"><span class="vote-button__vote-count">0</span></div><div class="vote-button__button--down vote-button__button"><span class="fa fa-angle-down"></span></div></div></div></span><div class="discussion-comment__body"><div class="forum-message-content"><p>That's quite straightforward with Keras' embedding layer. Just check out the kernels for this competition, you will find lots of examples.</p></div><span class=""></span><div class="file-list file-list--compact"></div><div class="file-list file-list--compact"></div></div></div></div><!-- react-empty: 950 --></div><div class="discussion-comment__linking-line"></div></div></div></div><!-- react-empty: 952 --></div><div class="comment-list__comment-linking-spacer"></div><div id="280366"><!-- react-empty: 955 --><div class="comment-wrapper"><div class="discussion-comment__author"><a class="avatar" href="https://www.kaggle.com/surachen" style="width: 40px;"><img class="avatar__thumbnail" src="./Using FastText models for robust embeddings _ Kaggle_files/1456685-kg.jpg" alt="SuraChen" width="40" height="40" style="border-radius: 4px;"><img class="avatar__tier" src="./Using FastText models for robust embeddings _ Kaggle_files/avatier-novice@2x.png" width="40" style="margin-top: 2px;"></a></div><div class="discussion-comment discussion-comment--parent"><span class="discussion-comment__title"><span class="discussion-comment__title-author-link-wrapper"><a class="discussion-comment__title-author-link" href="https://www.kaggle.com/surachen" title="SuraChen">SuraChen</a></span><span class="discussion-comment__title-element">•</span><span class="discussion-comment__title-element">Posted on Version 7</span><span class="discussion-comment__title-element">•</span><span class="discussion-comment__title-element"><span title="Fri Feb 09 2018 14:21:11 GMT-0600 (CST)">15 days ago</span></span><span class="discussion-comment__title-element">•</span><a class="discussion-comment__title-element discussion-comment__title-element--link">Options</a><span class="discussion-comment__title-element">•</span><a class="discussion-comment__title-element discussion-comment__title-element--link">Reply</a><span class="discussion-comment__title-element--spacer"></span><div class="vote-button__container "><div class="vote-button vote-button--compact vote-button--enabled vote-button--has-downvote"><div class="vote-button__button vote-button__button--up"><span class="fa fa-angle-up"></span></div><div class="vote-button__button vote-button__button--up"><span class="vote-button__vote-count">0</span></div><div class="vote-button__button--down vote-button__button"><span class="fa fa-angle-down"></span></div></div></div></span><div class="discussion-comment__body"><div class="forum-message-content"><p>Hi! Max！
i still don't know your idea,..could you explains why use FastText Word Vecvor directly can better than using FastText Word Vector as EmbeddingLayer? 
thx to explaint it! </p></div><span class=""></span><div class="file-list file-list--compact"></div><div class="file-list file-list--compact"></div></div><div class="discussion-comment__replies"><div id="280403"><!-- react-empty: 990 --><div class="comment-wrapper"><div class="discussion-comment__author"><a class="avatar" href="https://www.kaggle.com/mschumacher" style="width: 40px;"><img class="avatar__thumbnail" src="./Using FastText models for robust embeddings _ Kaggle_files/48845-gr.jpg" alt="Max Schumacher" width="40" height="40" style="border-radius: 4px;"><img class="avatar__tier" src="./Using FastText models for robust embeddings _ Kaggle_files/avatier-contributor@2x.png" width="40" style="margin-top: 2px;"></a></div><div class="discussion-comment"><span class="discussion-comment__title"><span class="discussion-comment__title-author-link-wrapper"><a class="discussion-comment__title-author-link discussion-comment__title-author-link--topic-author" href="https://www.kaggle.com/mschumacher" title="Max Schumacher">Max Schumacher</a></span><span class="discussion-comment__title-element">•</span><span class="discussion-comment__title-element">Posted on Version 7</span><span class="discussion-comment__title-element">•</span><span class="discussion-comment__title-element"><span title="Fri Feb 09 2018 16:28:54 GMT-0600 (CST)">15 days ago</span></span><span class="discussion-comment__title-element">•</span><a class="discussion-comment__title-element discussion-comment__title-element--link">Options</a><span class="discussion-comment__title-element">•</span><a class="discussion-comment__title-element discussion-comment__title-element--link">Reply</a><span class="discussion-comment__title-element--spacer"></span><div class="vote-button__container "><div class="vote-button vote-button--compact vote-button--enabled vote-button--has-downvote"><div class="vote-button__button vote-button__button--up"><span class="fa fa-angle-up"></span></div><div class="vote-button__button vote-button__button--up"><span class="vote-button__vote-count">0</span></div><div class="vote-button__button--down vote-button__button"><span class="fa fa-angle-down"></span></div></div></div></span><div class="discussion-comment__body"><div class="forum-message-content"><p>Hi Sura! The main advantage is that you can generate embeddings for out-of-vocab words, and then go even further and add random typos etc. in your generator. That way, the network should generalize much better in the space of possible (mis-)spellings. Does that help?</p></div><span class=""></span><div class="file-list file-list--compact"></div><div class="file-list file-list--compact"></div></div></div></div><!-- react-empty: 1023 --></div><div class="discussion-comment__linking-line"></div><div id="280555"><!-- react-empty: 1026 --><div class="comment-wrapper"><div class="discussion-comment__author"><a class="avatar" href="https://www.kaggle.com/surachen" style="width: 40px;"><img class="avatar__thumbnail" src="./Using FastText models for robust embeddings _ Kaggle_files/1456685-kg.jpg" alt="SuraChen" width="40" height="40" style="border-radius: 4px;"><img class="avatar__tier" src="./Using FastText models for robust embeddings _ Kaggle_files/avatier-novice@2x.png" width="40" style="margin-top: 2px;"></a></div><div class="discussion-comment"><span class="discussion-comment__title"><span class="discussion-comment__title-author-link-wrapper"><a class="discussion-comment__title-author-link" href="https://www.kaggle.com/surachen" title="SuraChen">SuraChen</a></span><span class="discussion-comment__title-element">•</span><span class="discussion-comment__title-element">Posted on Version 7</span><span class="discussion-comment__title-element">•</span><span class="discussion-comment__title-element"><span title="Sat Feb 10 2018 02:26:53 GMT-0600 (CST)">15 days ago</span></span><span class="discussion-comment__title-element">•</span><a class="discussion-comment__title-element discussion-comment__title-element--link">Options</a><span class="discussion-comment__title-element">•</span><a class="discussion-comment__title-element discussion-comment__title-element--link">Reply</a><span class="discussion-comment__title-element--spacer"></span><div class="vote-button__container "><div class="vote-button vote-button--compact vote-button--enabled vote-button--has-downvote"><div class="vote-button__button vote-button__button--up"><span class="fa fa-angle-up"></span></div><div class="vote-button__button vote-button__button--up"><span class="vote-button__vote-count">0</span></div><div class="vote-button__button--down vote-button__button"><span class="fa fa-angle-down"></span></div></div></div></span><div class="discussion-comment__body"><div class="forum-message-content"><p>THX Max ! really help, i test it local, that wonderful!
with testing your great work, i think your idea is brilliant, and i will try to find  more extra dataset and training with fasttext, maybe i can share with your work~!</p></div><span class=""></span><div class="file-list file-list--compact"></div><div class="file-list file-list--compact"></div></div></div></div><!-- react-empty: 1059 --></div><div class="discussion-comment__linking-line"></div></div></div></div><!-- react-empty: 1061 --></div><div class="comment-list__comment-linking-spacer"></div><div id="285538"><!-- react-empty: 1064 --><div class="comment-wrapper"><div class="discussion-comment__author"><a class="avatar" href="https://www.kaggle.com/chrain" style="width: 40px;"><img class="avatar__thumbnail" src="./Using FastText models for robust embeddings _ Kaggle_files/default-thumb.png" alt="chrain" width="40" height="40" style="border-radius: 4px;"><img class="avatar__tier" src="./Using FastText models for robust embeddings _ Kaggle_files/avatier-contributor@2x.png" width="40" style="margin-top: 2px;"></a></div><div class="discussion-comment"><span class="discussion-comment__title"><span class="discussion-comment__title-author-link-wrapper"><a class="discussion-comment__title-author-link" href="https://www.kaggle.com/chrain" title="chrain">chrain</a></span><span class="discussion-comment__title-element">•</span><span class="discussion-comment__title-element">Posted on Latest Version</span><span class="discussion-comment__title-element">•</span><span class="discussion-comment__title-element"><span title="Tue Feb 20 2018 08:52:44 GMT-0600 (CST)">5 days ago</span></span><span class="discussion-comment__title-element">•</span><a class="discussion-comment__title-element discussion-comment__title-element--link">Options</a><span class="discussion-comment__title-element">•</span><a class="discussion-comment__title-element discussion-comment__title-element--link">Reply</a><span class="discussion-comment__title-element--spacer"></span><div class="vote-button__container "><div class="vote-button vote-button--compact vote-button--enabled vote-button--has-downvote"><div class="vote-button__button vote-button__button--up"><span class="fa fa-angle-up"></span></div><div class="vote-button__button vote-button__button--up"><span class="vote-button__vote-count">0</span></div><div class="vote-button__button--down vote-button__button"><span class="fa fa-angle-down"></span></div></div></div></span><div class="discussion-comment__body"><div class="forum-message-content"><p>Thank you for the helpful script!</p></div><span class=""></span><div class="file-list file-list--compact"></div><div class="file-list file-list--compact"></div></div></div></div><!-- react-empty: 1097 --></div><div class="comment-list__comment-linking-spacer"></div><div id="286980"><!-- react-empty: 1100 --><div class="comment-wrapper"><div class="discussion-comment__author"><a class="avatar" href="https://www.kaggle.com/zceezzh" style="width: 40px;"><img class="avatar__thumbnail" src="./Using FastText models for robust embeddings _ Kaggle_files/1565977-kg.jpeg" alt="Zhedong Zheng" width="40" height="40" style="border-radius: 4px;"><img class="avatar__tier" src="./Using FastText models for robust embeddings _ Kaggle_files/avatier-novice@2x.png" width="40" style="margin-top: 2px;"></a></div><div class="discussion-comment discussion-comment--parent"><span class="discussion-comment__title"><span class="discussion-comment__title-author-link-wrapper"><a class="discussion-comment__title-author-link" href="https://www.kaggle.com/zceezzh" title="Zhedong Zheng">Zhedong Zheng</a></span><span class="discussion-comment__title-element">•</span><span class="discussion-comment__title-element">Posted on Latest Version</span><span class="discussion-comment__title-element">•</span><span class="discussion-comment__title-element"><span title="Thu Feb 22 2018 23:59:45 GMT-0600 (CST)">2 days ago</span></span><span class="discussion-comment__title-element">•</span><a class="discussion-comment__title-element discussion-comment__title-element--link">Options</a><span class="discussion-comment__title-element">•</span><a class="discussion-comment__title-element discussion-comment__title-element--link">Reply</a><span class="discussion-comment__title-element--spacer"></span><div class="vote-button__container "><div class="vote-button vote-button--compact vote-button--enabled vote-button--has-downvote"><div class="vote-button__button vote-button__button--up"><span class="fa fa-angle-up"></span></div><div class="vote-button__button vote-button__button--up"><span class="vote-button__vote-count">0</span></div><div class="vote-button__button--down vote-button__button"><span class="fa fa-angle-down"></span></div></div></div></span><div class="discussion-comment__body"><div class="forum-message-content"><p>Does anyone else meet the problem of load_model as an issue here (<a href="https://github.com/salestock/fastText.py/issues/148">https://github.com/salestock/fastText.py/issues/148</a>)?</p></div><span class=""></span><div class="file-list file-list--compact"></div><div class="file-list file-list--compact"></div></div><div class="discussion-comment__replies"><div id="287003"><!-- react-empty: 1135 --><div class="comment-wrapper"><div class="discussion-comment__author"><a class="avatar" href="https://www.kaggle.com/byeongilko" style="width: 40px;"><img class="avatar__thumbnail" src="./Using FastText models for robust embeddings _ Kaggle_files/318930-gr.jpg" alt="byeongil ko" width="40" height="40" style="border-radius: 4px;"><img class="avatar__tier" src="./Using FastText models for robust embeddings _ Kaggle_files/avatier-novice@2x.png" width="40" style="margin-top: 2px;"></a></div><div class="discussion-comment"><span class="discussion-comment__title"><span class="discussion-comment__title-author-link-wrapper"><a class="discussion-comment__title-author-link" href="https://www.kaggle.com/byeongilko" title="byeongil ko">byeongil ko</a></span><span class="discussion-comment__title-element">•</span><span class="discussion-comment__title-element">Posted on Latest Version</span><span class="discussion-comment__title-element">•</span><span class="discussion-comment__title-element"><span title="Fri Feb 23 2018 02:18:26 GMT-0600 (CST)">2 days ago</span></span><span class="discussion-comment__title-element">•</span><a class="discussion-comment__title-element discussion-comment__title-element--link">Options</a><span class="discussion-comment__title-element">•</span><a class="discussion-comment__title-element discussion-comment__title-element--link">Reply</a><span class="discussion-comment__title-element--spacer"></span><div class="vote-button__container "><div class="vote-button vote-button--compact vote-button--enabled vote-button--has-downvote"><div class="vote-button__button vote-button__button--up"><span class="fa fa-angle-up"></span></div><div class="vote-button__button vote-button__button--up"><span class="vote-button__vote-count">0</span></div><div class="vote-button__button--down vote-button__button"><span class="fa fa-angle-down"></span></div></div></div></span><div class="discussion-comment__body"><div class="forum-message-content"><p><a href="https://pypi.python.org/pypi/pyfasttext/">https://pypi.python.org/pypi/pyfasttext/</a> is other way to solve your problem, in my case..</p></div><span class=""></span><div class="file-list file-list--compact"></div><div class="file-list file-list--compact"></div></div></div></div><!-- react-empty: 1168 --></div><div class="discussion-comment__linking-line"></div></div></div></div><!-- react-empty: 1170 --></div><div class="comment-list__comment-linking-spacer"></div></div></div><div class="content-box"><!-- react-text: 208 --><!-- /react-text --><div><div class="content-box__title-bar"><div class="content-box__title" style="line-height: 46px;">Similar Kernels</div></div></div><div class="content-box__content-section"><div class="SuggestionsWrapper-jrrtHK kxcRzO"><div class="block-link SuggestionWrapper-bZXlPl cQHAib block-link--bordered"><a class="block-link__anchor" href="https://www.kaggle.com/jhoward/nb-svm-strong-linear-baseline"></a><div class="ContentWrapper-bvWSlK brmgEU"><div class="SuggestionImageWrapper-jCWKMo gAjEXu"><img class="SuggestionImage-gkRBSt fmXzjq" alt="NB-SVM strong linear baseline" src="./Using FastText models for robust embeddings _ Kaggle_files/thumb76_76.png"></div><div class="InfoWrapper-cgkVcx cAedFl"><span class="InfoTitle-hwGaFo eIqlf">NB-SVM strong linear baseline</span></div></div></div><div class="block-link SuggestionWrapper-bZXlPl cQHAib block-link--bordered"><a class="block-link__anchor" href="https://www.kaggle.com/jagangupta/stop-the-s-toxic-comments-eda"></a><div class="ContentWrapper-bvWSlK brmgEU"><div class="SuggestionImageWrapper-jCWKMo gAjEXu"><img class="SuggestionImage-gkRBSt fmXzjq" alt="Stop the S@#$ - Toxic Comments EDA" src="./Using FastText models for robust embeddings _ Kaggle_files/thumb76_76.png"></div><div class="InfoWrapper-cgkVcx cAedFl"><span class="InfoTitle-hwGaFo eIqlf">Stop the S@#$ - Toxic Comments EDA</span></div></div></div><div class="block-link SuggestionWrapper-bZXlPl cQHAib block-link--bordered"><a class="block-link__anchor" href="https://www.kaggle.com/CVxTz/keras-bidirectional-lstm-baseline-lb-0-069"></a><div class="ContentWrapper-bvWSlK brmgEU"><div class="SuggestionImageWrapper-jCWKMo gAjEXu"><img class="SuggestionImage-gkRBSt fmXzjq" alt="Keras - Bidirectional LSTM baseline ( lb 0.069)" src="./Using FastText models for robust embeddings _ Kaggle_files/thumb76_76.png"></div><div class="InfoWrapper-cgkVcx cAedFl"><span class="InfoTitle-hwGaFo eIqlf">Keras - Bidirectional LSTM baseline ( lb 0.069)</span></div></div></div><div class="block-link SuggestionWrapper-bZXlPl cQHAib block-link--bordered"><a class="block-link__anchor" href="https://www.kaggle.com/jhoward/improved-lstm-baseline-glove-dropout"></a><div class="ContentWrapper-bvWSlK brmgEU"><div class="SuggestionImageWrapper-jCWKMo gAjEXu"><img class="SuggestionImage-gkRBSt fmXzjq" alt="Improved LSTM baseline: GloVe + dropout" src="./Using FastText models for robust embeddings _ Kaggle_files/thumb76_76.png"></div><div class="InfoWrapper-cgkVcx cAedFl"><span class="InfoTitle-hwGaFo eIqlf">Improved LSTM baseline: GloVe + dropout</span></div></div></div><div class="block-link SuggestionWrapper-bZXlPl cQHAib block-link--bordered"><a class="block-link__anchor" href="https://www.kaggle.com/tunguz/logistic-regression-with-words-and-char-n-grams"></a><div class="ContentWrapper-bvWSlK brmgEU"><div class="SuggestionImageWrapper-jCWKMo gAjEXu"><img class="SuggestionImage-gkRBSt fmXzjq" alt="Logistic regression with words and char n-grams" src="./Using FastText models for robust embeddings _ Kaggle_files/thumb76_76.png"></div><div class="InfoWrapper-cgkVcx cAedFl"><span class="InfoTitle-hwGaFo eIqlf">Logistic regression with words and char n-grams</span></div></div></div></div></div></div></div></div><!-- react-empty: 249 --><!-- react-empty: 250 --></div></div><script>var Kaggle=window.Kaggle||{};Kaggle.State=Kaggle.State||[];Kaggle.State.push({"pageMessages":[],"log":"[{\n  \u0022data\u0022: \u0022[NbConvertApp] Converting notebook script.ipynb to html\\n\u0022,\n  \u0022stream_name\u0022: \u0022stderr\u0022,\n  \u0022time\u0022: 4.273617936996743\n},{\n  \u0022data\u0022: \u0022[NbConvertApp] ERROR | Notebook JSON is invalid: Additional properties are not allowed (\u0027execution_count\u0027, \u0027outputs\u0027 were unexpected)\\n\\nFailed validating \u0027additionalProperties\u0027 in markdown_cell:\\n\\nOn instance[\u0027cells\u0027][0]:\\n{\u0027cell_type\u0027: \u0027markdown\u0027,\\n \u0027execution_count\u0027: None,\\n \u0027metadata\u0027: {\u0027_cell_guid\u0027: \u00275c86b9bc-a478-4da9-adcc-b97ca0fbd0c9\u0027,\\n              \u0027_uuid\u0027: \u002753d59528c17da4c1d9759786326a82d0c8765804\u0027},\\n \u0027outputs\u0027: [\u0027...0 outputs...\u0027],\\n \u0027source\u0027: \u0027# Using FastText models (not vectors) for robust embeddings\\\\n\u0027\\n           \u0027\\\\n\u0027\\n           \\\u0022I\u0027d...\\\u0022}\\n[NbConvertApp] Executing notebook with kernel: python3\\n\u0022,\n  \u0022stream_name\u0022: \u0022stderr\u0022,\n  \u0022time\u0022: 4.309589229989797\n},{\n  \u0022data\u0022: \u0022[NbConvertApp] Writing 289888 bytes to __results__.html\\n\u0022,\n  \u0022stream_name\u0022: \u0022stderr\u0022,\n  \u0022time\u0022: 11.428101472003618\n}]","code":"{\u0022cells\u0022:[{\u0022metadata\u0022:{\u0022_uuid\u0022:\u002253d59528c17da4c1d9759786326a82d0c8765804\u0022,\u0022_cell_guid\u0022:\u00225c86b9bc-a478-4da9-adcc-b97ca0fbd0c9\u0022},\u0022cell_type\u0022:\u0022markdown\u0022,\u0022source\u0022:\u0022# Using FastText models (not vectors) for robust embeddings\\n\\nI\u0027d like to explain my approach of using pretrained FastText models as input to Keras Neural Networks. FastText is a word embedding not unlike Word2Vec or GloVe, but the cool thing is that each word vector is based on sub-word character n-grams. That means that even for previously unseen words (e.g. due to typos), the model can make an educated guess towards its meaning. To find out more about FastText, check out both their [Github](https://github.com/facebookresearch/fastText/) and [website](https://fasttext.cc/).\\n\\nTo do this, we won\u0027t be using the classic Keras embedding layer and instead hand-craft the embedding for each example. As a result, we need to  write more code and invest some time into preprocessing, but that is easily justified by the results.\\n\\n**Disclaimer: Loading the FastText model will take some serious memory! I recommend having at least 60 GB of RAM. EC2\u0027s p2.xlarge instance should have no problems with this, but you can always [add some swap](https://stackoverflow.com/questions/17173972/how-do-you-add-swap-to-an-ec2-instance) for good measure. I also added a section below to build a training generator for this.**\u0022,\u0022outputs\u0022:[],\u0022execution_count\u0022:null},{\u0022metadata\u0022:{\u0022_uuid\u0022:\u0022168f1efdabebb51c2922aab58231921599f9348f\u0022,\u0022_cell_guid\u0022:\u0022b88f84eb-051c-4fe8-8fc0-70365a0b9693\u0022},\u0022cell_type\u0022:\u0022markdown\u0022,\u0022source\u0022:\u0022## Preparations: Getting FastText and the model\\n\\nFirst, build FastText from sources as described [here](https://github.com/facebookresearch/fastText#requirements). Don\u0027t worry, there\u0027s nothing crazy you have to do and it will finish in less than a minute. Next, install the Python package in your virtualenv following [these instructions](https://github.com/facebookresearch/fastText/tree/master/python).\\n\\nFor the model, I use the one pretrained on English Wikipedia. I\u0027d love to have one trained on Twitter or similar, since it might be more internet-slangy, but I haven\u0027t found any yet and don\u0027t feel like pretraining one myself. Download the model [here](https://github.com/facebookresearch/fastText/blob/master/pretrained-vectors.md). Make sure you get the bin, not just the vec (text) file. I\u0027ll assume you placed it (or a symlink to it) into your code directory and named it `ft_model.bin`.\u0022,\u0022outputs\u0022:[],\u0022execution_count\u0022:null},{\u0022metadata\u0022:{\u0022_uuid\u0022:\u0022e4542f71483666b9168dacc6949bcbaff8b66642\u0022,\u0022_cell_guid\u0022:\u0022eea9d34b-3205-421f-bfd8-6e29f8092ddd\u0022},\u0022cell_type\u0022:\u0022markdown\u0022,\u0022source\u0022:\u0022## Preparations: Exploring the model\\n\\nLet\u0027s explore the model! Go to your FastText directory and run `./fasttext nn \u003cpath_to_ft_model\u003e`. Now you can enter some terms and see the nearest neighbors to this word in the embedding space. Here are some examples:\\n\\n```\\nQuery word? queen\\n—queen 0.719091\\n‘queen 0.692849\\n#queen 0.656498\\nqueena 0.650313\\nking 0.64931\\nqueen`s 0.63954\\nking/queen 0.634855\\ns/queen 0.627386\\nprincess 0.623889\\nqueeny 0.620919\\n```\\n\\nOk that looks pretty ugly. I suppose Facebook was not very exact in their cleaning of the input data. But some sensible suggestions are there: `king` and `princess`! Let\u0027s try a typo that is unlikely to have appeared in the original data:\\n\\n```\\nQuery word? dimensionnallity\\ndimension, 0.722278\\ndimensionality 0.708645\\ndimensionful 0.698573\\ncodimension 0.689754\\ncodimensions 0.67555\\ntwodimensional 0.674745\\ndimension 0.67258\\n\\\\,kdimensional 0.668848\\n‘dimensions 0.665725\\ntwo–dimensional 0.665109\\n```\\n\\nSweet! Even though it has never seen that word, it recognizes it to be related with \\\u0022dimensionality\\\u0022. Let\u0027s try some something mean:\\n\\n```\\nQuery word? dumb\\nstupid 0.746051\\ndumber 0.732965\\nclueless 0.662594\\nidiotic 0.64993\\nsilly 0.632314\\nstupidstitious 0.628875\\nstupidly 0.622968\\nmoronic 0.621633\\nignorant 0.620475\\nstupider 0.617377\\n```\\n\\nNice! Even though this was trained on Wikipedia, we\u0027re getting at least some basic insults. I\u0027ll leave it to you to explore the really hateful words. They all seem to be there ;)\\n\\n**Note:** Keep in mind that exploring the nearest neighbors is a very superficial approach to understanding the model! The embedding space has 300 dimensions, and we boil them down to a single distance metric. We can\u0027t be sure in which dimensions these words are related to each other, but we can trust in the model to have learnt something sensible.\\n\\n**Pro tip:** Our data should be cleaned and normalized in a similar way as Facebook did before they trained this model. We can query the model to get some insights into what they did, e.g.\\n\\n```\\nQuery word? 1\\ninsel 0.483141\\ninseln 0.401125\\n...\\nQuery word? one\\ntwo 0.692744\\nthree 0.676568\\n...\\n```\\n\\nThis tells us they converted all numbers to their text equivalent, and so should we!\u0022,\u0022outputs\u0022:[],\u0022execution_count\u0022:null},{\u0022metadata\u0022:{\u0022_uuid\u0022:\u0022ae7a32ce6f66748656faecde4d079857b992ac1e\u0022,\u0022_cell_guid\u0022:\u00222f03f7c4-ecc8-47d3-8c59-9e4482e7684a\u0022},\u0022cell_type\u0022:\u0022markdown\u0022,\u0022source\u0022:\u0022## Loading and cleaning the data\\n\\nWe define a method `normalize` to clean and prepare a single string. We will use it later to prepare our string data. Also, we load the data as we\u0027re used to:\u0022,\u0022outputs\u0022:[],\u0022execution_count\u0022:null},{\u0022metadata\u0022:{\u0022_uuid\u0022:\u0022fa74d030d08aff58c32455cd4218d9ff0ef494d9\u0022,\u0022collapsed\u0022:true,\u0022_kg_hide-output\u0022:true,\u0022_cell_guid\u0022:\u0022423398cb-482b-4dc3-9904-82c2d17d2e2c\u0022,\u0022trusted\u0022:false},\u0022cell_type\u0022:\u0022code\u0022,\u0022source\u0022:\u0022import re\\nimport numpy as np\\nimport pandas as pd\\nfrom fastText import load_model\\n\\nwindow_length = 200 # The amount of words we look at per example. Experiment with this.\\n\\ndef normalize(s):\\n    \\\u0022\\\u0022\\\u0022\\n    Given a text, cleans and normalizes it. Feel free to add your own stuff.\\n    \\\u0022\\\u0022\\\u0022\\n    s = s.lower()\\n    # Replace ips\\n    s = re.sub(r\u0027\\\\d{1,3}\\\\.\\\\d{1,3}\\\\.\\\\d{1,3}\\\\.\\\\d{1,3}\u0027, \u0027 _ip_ \u0027, s)\\n    # Isolate punctuation\\n    s = re.sub(r\u0027([\\\\\u0027\\\\\\\u0022\\\\.\\\\(\\\\)\\\\!\\\\?\\\\-\\\\\\\\\\\\/\\\\,])\u0027, r\u0027 \\\\1 \u0027, s)\\n    # Remove some special characters\\n    s = re.sub(r\u0027([\\\\;\\\\:\\\\|•«\\\\n])\u0027, \u0027 \u0027, s)\\n    # Replace numbers and symbols with language\\n    s = s.replace(\u0027\u0026\u0027, \u0027 and \u0027)\\n    s = s.replace(\u0027@\u0027, \u0027 at \u0027)\\n    s = s.replace(\u00270\u0027, \u0027 zero \u0027)\\n    s = s.replace(\u00271\u0027, \u0027 one \u0027)\\n    s = s.replace(\u00272\u0027, \u0027 two \u0027)\\n    s = s.replace(\u00273\u0027, \u0027 three \u0027)\\n    s = s.replace(\u00274\u0027, \u0027 four \u0027)\\n    s = s.replace(\u00275\u0027, \u0027 five \u0027)\\n    s = s.replace(\u00276\u0027, \u0027 six \u0027)\\n    s = s.replace(\u00277\u0027, \u0027 seven \u0027)\\n    s = s.replace(\u00278\u0027, \u0027 eight \u0027)\\n    s = s.replace(\u00279\u0027, \u0027 nine \u0027)\\n    return s\\n\\nprint(\u0027\\\\nLoading data\u0027)\\ntrain = pd.read_csv(\u0027../input/train.csv\u0027)\\ntest = pd.read_csv(\u0027../input/test.csv\u0027)\\ntrain[\u0027comment_text\u0027] = train[\u0027comment_text\u0027].fillna(\u0027_empty_\u0027)\\ntest[\u0027comment_text\u0027] = test[\u0027comment_text\u0027].fillna(\u0027_empty_\u0027)\u0022,\u0022execution_count\u0022:null,\u0022outputs\u0022:[]},{\u0022metadata\u0022:{\u0022_uuid\u0022:\u0022a4099da988bbe670ee7b389071e924ca1891cec2\u0022,\u0022_cell_guid\u0022:\u0022d98e8058-b635-408f-98ca-c0b999bc310c\u0022},\u0022cell_type\u0022:\u0022markdown\u0022,\u0022source\u0022:\u0022Ok next, let\u0027s load the FastText model and define methods that convert text to a sequence of vectors. Note that I\u0027m just considering the last n words of each text. You could play with this, too.\u0022,\u0022outputs\u0022:[],\u0022execution_count\u0022:null},{\u0022metadata\u0022:{\u0022_uuid\u0022:\u0022d5a8656a2cb0b9cde191230f477faa17934180c9\u0022,\u0022collapsed\u0022:true,\u0022_kg_hide-output\u0022:true,\u0022_cell_guid\u0022:\u00225792a3ad-8b04-435f-bd3d-f54d7449921b\u0022,\u0022trusted\u0022:false},\u0022cell_type\u0022:\u0022code\u0022,\u0022source\u0022:\u0022classes = [\\n    \u0027toxic\u0027, \u0027severe_toxic\u0027, \u0027obscene\u0027, \u0027threat\u0027, \u0027insult\u0027, \u0027identity_hate\u0027\\n]\\n\\nprint(\u0027\\\\nLoading FT model\u0027)\\nft_model = load_model(\u0027ft_model.bin\u0027)\\nn_features = ft_model.get_dimension()\\n\\ndef text_to_vector(text):\\n    \\\u0022\\\u0022\\\u0022\\n    Given a string, normalizes it, then splits it into words and finally converts\\n    it to a sequence of word vectors.\\n    \\\u0022\\\u0022\\\u0022\\n    text = normalize(text)\\n    words = text.split()\\n    window = words[-window_length:]\\n    \\n    x = np.zeros((window_length, n_features))\\n\\n    for i, word in enumerate(window):\\n        x[i, :] = ft_model.get_word_vector(word).astype(\u0027float32\u0027)\\n\\n    return x\\n\\ndef df_to_data(df):\\n    \\\u0022\\\u0022\\\u0022\\n    Convert a given dataframe to a dataset of inputs for the NN.\\n    \\\u0022\\\u0022\\\u0022\\n    x = np.zeros((len(df), window_length, n_features), dtype=\u0027float32\u0027)\\n\\n    for i, comment in enumerate(df[\u0027comment_text\u0027].values):\\n        x[i, :] = text_to_vector(comment)\\n\\n    return x\u0022,\u0022execution_count\u0022:null,\u0022outputs\u0022:[]},{\u0022metadata\u0022:{\u0022_uuid\u0022:\u0022ae35399a098729b8e68d76a953d4c097917438bb\u0022,\u0022_cell_guid\u0022:\u0022d9bc312a-e444-4058-b4ac-3f30d3d98940\u0022},\u0022cell_type\u0022:\u0022markdown\u0022,\u0022source\u0022:\u0022To convert an input dataframe to an input vector, just call `df_to_data`. This will result in the shape `(n_examples, window_length, n_features)`. Here, for each row we would have 200 words a 300 features each.\\n\\n**EDIT/NOTE:** This will probably not fit into your memory, so don\u0027t bother executing it :) Instead, read my generator guide below.\u0022,\u0022outputs\u0022:[],\u0022execution_count\u0022:null},{\u0022metadata\u0022:{\u0022_uuid\u0022:\u00226a34513a82b5140d5e5c258f5c6427b83ae62245\u0022,\u0022collapsed\u0022:true,\u0022_kg_hide-output\u0022:true,\u0022_cell_guid\u0022:\u00221c98dd07-36b1-4b7f-b806-6a5d8bdabae1\u0022,\u0022trusted\u0022:false},\u0022cell_type\u0022:\u0022code\u0022,\u0022source\u0022:\u0022x_train = df_to_data(train)\\ny_train = train[classes].values\\n\\nx_test = df_to_data(test)\\ny_test = test[classes].values\u0022,\u0022execution_count\u0022:null,\u0022outputs\u0022:[]},{\u0022metadata\u0022:{\u0022_uuid\u0022:\u00227b41f089ef0d93d41d565e99b03c0f19b30f26ce\u0022,\u0022_cell_guid\u0022:\u00224f582bb5-ac4b-4b67-8e34-6fa022416e57\u0022},\u0022cell_type\u0022:\u0022markdown\u0022,\u0022source\u0022:\u0022And now you should be good to go! Train this as usual. You don\u0027t need an `EmbeddingLayer`, but you need to pass `input_shape=(window_length, n_features)` to the first layer in your NN.\\n\\nI\u0027m still in the process of experimenting, but I already achieved a single-model LB score of `0.9842` with something very simple. Bagging multiple of these models got me into the top 100 easily. Good luck!\u0022,\u0022outputs\u0022:[],\u0022execution_count\u0022:null},{\u0022metadata\u0022:{\u0022_uuid\u0022:\u00224dfea6e85ca933626a14ce2df8e937051b863d0a\u0022,\u0022_cell_guid\u0022:\u00224bb7ba9a-7c32-43db-9c52-f4fca204ab12\u0022},\u0022cell_type\u0022:\u0022markdown\u0022,\u0022source\u0022:\u0022### PS: Using a generator so you don\u0027t have to keep the whole damn thing in memory\\nAs @liujilong pointed out, not even the p2.xlarge machine with 64 GB can hold both the training and test set for window sizes longer than ~100 words. It seems I underestimated how much memory this monster model eats! Also, locally I had long [added swap space](https://stackoverflow.com/questions/17173972/how-do-you-add-swap-to-an-ec2-instance) and switched to generators so I wouldn\u0027t have to keep the whole thing memory. Let me show you how to implement the generator part. This is also useful to add some randomization later on.\\n\\nThe idea is that instead of converting the whole training set to one large array, we can write a function that just spits out one batch of data at a time, infinitely. Keras can automaticaly spin up a separate thread for this method (note though that \\\u0022threads\\\u0022 in Python are ridiculous and do not give any speedup whatsoever). This means that we have to write some more code and training will be slightly slower, but we need only a fraction of the memory and we can add some cool randomization to each batch later on (see ideas section below).\\n\\nWe can keep all the code from above. This generator method works only for training data, not for validation data, so you will need to split by hand. Let\u0027s do that now:\u0022,\u0022outputs\u0022:[],\u0022execution_count\u0022:null},{\u0022metadata\u0022:{\u0022_uuid\u0022:\u002274becdb6b32d5676e1f4a0d67b38a0ba355dac97\u0022,\u0022collapsed\u0022:true,\u0022_kg_hide-output\u0022:true,\u0022_cell_guid\u0022:\u0022f71c2d37-2a1e-483a-af4c-5e7c820ad29c\u0022,\u0022trusted\u0022:false},\u0022cell_type\u0022:\u0022code\u0022,\u0022source\u0022:\u0022# Split the dataset:\\nsplit_index = round(len(train) * 0.9)\\nshuffled_train = train.sample(frac=1)\\ndf_train = shuffled_train.iloc[:split_index]\\ndf_val = shuffled_train.iloc[split_index:]\\n\\n# Convert validation set to fixed array\\nx_val = df_to_data(df_val)\\ny_val = df_val[classes].values\\n\\ndef data_generator(df, batch_size):\\n    \\\u0022\\\u0022\\\u0022\\n    Given a raw dataframe, generates infinite batches of FastText vectors.\\n    \\\u0022\\\u0022\\\u0022\\n    batch_i = 0 # Counter inside the current batch vector\\n    batch_x = None # The current batch\u0027s x data\\n    batch_y = None # The current batch\u0027s y data\\n    \\n    while True: # Loop forever\\n        df = df.sample(frac=1) # Shuffle df each epoch\\n        \\n        for i, row in df.iterrows():\\n            comment = row[\u0027comment_text\u0027]\\n            \\n            if batch_x is None:\\n                batch_x = np.zeros((batch_size, window_length, n_features), dtype=\u0027float32\u0027)\\n                batch_y = np.zeros((batch_size, len(classes)), dtype=\u0027float32\u0027)\\n                \\n            batch_x[batch_i] = text_to_vector(comment)\\n            batch_y[batch_i] = row[classes].values\\n            batch_i += 1\\n\\n            if batch_i == batch_size:\\n                # Ready to yield the batch\\n                yield batch_x, batch_y\\n                batch_x = None\\n                batch_y = None\\n                batch_i = 0\u0022,\u0022execution_count\u0022:null,\u0022outputs\u0022:[]},{\u0022metadata\u0022:{\u0022_uuid\u0022:\u002207d54b2346e24ebe9fd6dad691e129bd721a8b45\u0022,\u0022_cell_guid\u0022:\u00223e35540c-7ae8-4f38-ae70-a2d38bc1e189\u0022},\u0022cell_type\u0022:\u0022markdown\u0022,\u0022source\u0022:\u0022Alright, now we can use this generator to train the network. To make sure that one epoch has approxamitely the same number of examples as are in the training set, we need to set the `steps_per_epoch` to the number of batches we expect to cover the whole dataset. Here\u0027s the code:\u0022,\u0022outputs\u0022:[],\u0022execution_count\u0022:null},{\u0022metadata\u0022:{\u0022_uuid\u0022:\u0022f5b8b97f068e2884bc5e877a19afbc721ba135da\u0022,\u0022collapsed\u0022:true,\u0022_kg_hide-output\u0022:true,\u0022_cell_guid\u0022:\u00221be4d47d-6b43-4422-b77f-f103e784e721\u0022,\u0022trusted\u0022:false},\u0022cell_type\u0022:\u0022code\u0022,\u0022source\u0022:\u0022model = build_model()  # TODO: Implement\\n\\nbatch_size = 128\\ntraining_steps_per_epoch = round(len(df_train) / batch_size)\\ntraining_generator = data_generator(df_train, batch_size)\\n\\n# Ready to start training:\\nmodel.fit_generator(\\n    training_generator,\\n    steps_per_epoch=training_steps_per_epoch,\\n    batch_size=batch_size,\\n    validation_data=(x_val, y_val),\\n    ...\\n)\u0022,\u0022execution_count\u0022:null,\u0022outputs\u0022:[]},{\u0022metadata\u0022:{\u0022_uuid\u0022:\u0022e2b848800743d084611e07d9f93fefe444eb2f88\u0022,\u0022_cell_guid\u0022:\u00221af33152-8655-4aba-976e-b34a573940e8\u0022},\u0022cell_type\u0022:\u0022markdown\u0022,\u0022source\u0022:\u0022And there you go, this should work on p2.xlarge even for long window lengths!\u0022,\u0022outputs\u0022:[],\u0022execution_count\u0022:null},{\u0022metadata\u0022:{\u0022_uuid\u0022:\u002224d94ddbe3041de9a0ae252adb22b2d1354b3cff\u0022,\u0022_cell_guid\u0022:\u0022e9697a31-c4aa-4ec7-85f8-f93f95b57228\u0022},\u0022cell_type\u0022:\u0022markdown\u0022,\u0022source\u0022:\u0022### More stuff to try:\\nSome suggestions. I\u0027ve tried most of these and found them helpful:\\n\\n* Add random but common typos to strings before converting to FT vectors. That way, the model can learn in which way typos affect the embeddings. Use the training generator so you can adjust this over time.\\n* Add more string preprocessing to our `normalize` function\\n* Randomize the windows instead of using the end (great that we already have a generator!)\\n* Use FastText\u0027s sentence vector feature to summarize parts of the text outside the window\\n* Add other features ontop of the FT ones, e.g. capitalization etc.\u0022,\u0022outputs\u0022:[],\u0022execution_count\u0022:null}],\u0022metadata\u0022:{\u0022language_info\u0022:{\u0022name\u0022:\u0022python\u0022,\u0022version\u0022:\u00223.6.4\u0022,\u0022mimetype\u0022:\u0022text/x-python\u0022,\u0022codemirror_mode\u0022:{\u0022name\u0022:\u0022ipython\u0022,\u0022version\u0022:3},\u0022pygments_lexer\u0022:\u0022ipython3\u0022,\u0022nbconvert_exporter\u0022:\u0022python\u0022,\u0022file_extension\u0022:\u0022.py\u0022},\u0022kernelspec\u0022:{\u0022display_name\u0022:\u0022Python 3\u0022,\u0022language\u0022:\u0022python\u0022,\u0022name\u0022:\u0022python3\u0022}},\u0022nbformat\u0022:4,\u0022nbformat_minor\u0022:1}","languageName":"Python","htmlOutputFileUrl":"https://www.kaggleusercontent.com/kf/2456848/eyJhbGciOiJkaXIiLCJlbmMiOiJBMTI4Q0JDLUhTMjU2In0..0iVr0eKyUYXsvz0H7oLG0A.otbWi1rrdcweQ65fI9A4_rgeWtysMFSfhWgWwAUmTclQr8JehFYVT6MOs1RTBVfcUL6E9q671N4d0sWCDW6STjr4aDnPugI0HIQwTdSsQhMEtiXYgD049aCI8aLdlBDft8LqEFWUp8AI9ueeHFmXpQ.QlQwpfCsacsDrjL6LF2ZRw/__results__.html","outputFiles":[],"downloadAllFilesUrl":"/kernels/svzip/2456848","runInfo":{"isValidStatus":true,"failureMessage":"","exitCode":0,"succeeded":true,"dockerImageName":"gcr.io/kaggle-images/python","dockerfileUrl":"https://github.com/Kaggle/docker-python/blob/master/Dockerfile","dockerHubUrl":"https://registry.hub.docker.com/u/kaggle/python/","dockerImageId":"sha256:c81fe0a86a684b05f63f50d75dd4307c989db3810d2d425633989b50ceda959d","timeoutExceeded":false,"runTimeSeconds":12.1332556139969,"usedAllSpace":false,"queuedSeconds":1.003,"outputSizeBytes":289916},"versionHistory":[{"id":2456848,"isForkParent":false,"isNotebook":true,"languageName":"Python","lastRunTime":"2018-02-12T13:15:43.94Z","linesChangedFromPrevious":0,"linesDeletedFromPrevious":0,"linesInsertedFromPrevious":0,"outputFilesTotalSizeBytes":289899,"runInfo":{"dockerfileUrl":"https://github.com/Kaggle/docker-python/blob/master/Dockerfile","dockerHubUrl":"https://registry.hub.docker.com/u/kaggle/python/","dockerImageId":"sha256:c81fe0a86a684b05f63f50d75dd4307c989db3810d2d425633989b50ceda959d","dockerImageName":"gcr.io/kaggle-images/python","exitCode":0,"failureMessage":"","isValidStatus":true,"runTimeSeconds":12.1332556139969,"succeeded":true,"timeoutExceeded":false,"usedAllSpace":false},"status":"complete","title":"Using FastText models for robust embeddings","url":"/mschumacher/using-fasttext-models-for-robust-embeddings?scriptVersionId=2456848","versionNumber":8,"hasVersionNumber":true,"isDeleted":false,"dockerImage":{"scriptVersionId":2456848,"languageName":"Python","dockerImageVersionId":46,"dockerImageVersionCreationDate":"2018-02-04T23:16:27.09Z","dockerImageTag":"kaggle/python","dockerImageDigest":"0f4089a83e4f38898dc3a50aa6c756cbefaf8a25ec5811917257a60099c5af16"}},{"id":2395895,"isForkParent":false,"isNotebook":true,"languageName":"Python","lastRunTime":"2018-02-08T15:36:03.233Z","linesChangedFromPrevious":0,"linesDeletedFromPrevious":0,"linesInsertedFromPrevious":0,"outputFilesTotalSizeBytes":289894,"runInfo":{"dockerfileUrl":"https://github.com/Kaggle/docker-python/blob/master/Dockerfile","dockerHubUrl":"https://registry.hub.docker.com/u/kaggle/python/","dockerImageId":"sha256:c81fe0a86a684b05f63f50d75dd4307c989db3810d2d425633989b50ceda959d","dockerImageName":"gcr.io/kaggle-images/python","exitCode":0,"failureMessage":"","isValidStatus":true,"runTimeSeconds":9.8624823440332,"succeeded":true,"timeoutExceeded":false,"usedAllSpace":false},"status":"complete","title":"Using FastText models for robust embeddings","url":"/mschumacher/using-fasttext-models-for-robust-embeddings?scriptVersionId=2395895","versionNumber":7,"hasVersionNumber":true,"isDeleted":false,"dockerImage":{"scriptVersionId":2395895,"languageName":"Python","dockerImageVersionId":46,"dockerImageVersionCreationDate":"2018-02-04T23:16:27.09Z","dockerImageTag":"kaggle/python","dockerImageDigest":"0f4089a83e4f38898dc3a50aa6c756cbefaf8a25ec5811917257a60099c5af16"}},{"id":2394150,"isForkParent":false,"isNotebook":true,"languageName":"Python","lastRunTime":"2018-02-08T12:54:22.16Z","linesChangedFromPrevious":0,"linesDeletedFromPrevious":1,"linesInsertedFromPrevious":1,"outputFilesTotalSizeBytes":289446,"runInfo":{"dockerfileUrl":"https://github.com/Kaggle/docker-python/blob/master/Dockerfile","dockerHubUrl":"https://registry.hub.docker.com/u/kaggle/python/","dockerImageId":"sha256:c81fe0a86a684b05f63f50d75dd4307c989db3810d2d425633989b50ceda959d","dockerImageName":"gcr.io/kaggle-images/python","exitCode":0,"failureMessage":"","isValidStatus":true,"runTimeSeconds":10.080364916008,"succeeded":true,"timeoutExceeded":false,"usedAllSpace":false},"status":"complete","title":"Using FastText models for robust embeddings","url":"/mschumacher/using-fasttext-models-for-robust-embeddings?scriptVersionId=2394150","versionNumber":6,"hasVersionNumber":true,"isDeleted":false,"dockerImage":{"scriptVersionId":2394150,"languageName":"Python","dockerImageVersionId":46,"dockerImageVersionCreationDate":"2018-02-04T23:16:27.09Z","dockerImageTag":"kaggle/python","dockerImageDigest":"0f4089a83e4f38898dc3a50aa6c756cbefaf8a25ec5811917257a60099c5af16"}},{"id":2394135,"isForkParent":false,"isNotebook":true,"languageName":"Python","lastRunTime":"2018-02-08T12:52:54.36Z","linesChangedFromPrevious":0,"linesDeletedFromPrevious":6,"linesInsertedFromPrevious":6,"outputFilesTotalSizeBytes":289446,"runInfo":{"dockerfileUrl":"https://github.com/Kaggle/docker-python/blob/master/Dockerfile","dockerHubUrl":"https://registry.hub.docker.com/u/kaggle/python/","dockerImageId":"sha256:c81fe0a86a684b05f63f50d75dd4307c989db3810d2d425633989b50ceda959d","dockerImageName":"gcr.io/kaggle-images/python","exitCode":0,"failureMessage":"","isValidStatus":true,"runTimeSeconds":10.0438173850125,"succeeded":true,"timeoutExceeded":false,"usedAllSpace":false},"status":"complete","title":"Using FastText models for robust embeddings","url":"/mschumacher/using-fasttext-models-for-robust-embeddings?scriptVersionId=2394135","versionNumber":5,"hasVersionNumber":true,"isDeleted":false,"dockerImage":{"scriptVersionId":2394135,"languageName":"Python","dockerImageVersionId":46,"dockerImageVersionCreationDate":"2018-02-04T23:16:27.09Z","dockerImageTag":"kaggle/python","dockerImageDigest":"0f4089a83e4f38898dc3a50aa6c756cbefaf8a25ec5811917257a60099c5af16"}},{"id":2394086,"isForkParent":false,"isNotebook":true,"languageName":"Python","lastRunTime":"2018-02-08T12:46:23.057Z","linesChangedFromPrevious":0,"linesDeletedFromPrevious":1,"linesInsertedFromPrevious":1,"outputFilesTotalSizeBytes":289329,"runInfo":{"dockerfileUrl":"https://github.com/Kaggle/docker-python/blob/master/Dockerfile","dockerHubUrl":"https://registry.hub.docker.com/u/kaggle/python/","dockerImageId":"sha256:c81fe0a86a684b05f63f50d75dd4307c989db3810d2d425633989b50ceda959d","dockerImageName":"gcr.io/kaggle-images/python","exitCode":0,"failureMessage":"","isValidStatus":true,"runTimeSeconds":9.69159023603424,"succeeded":true,"timeoutExceeded":false,"usedAllSpace":false},"status":"complete","title":"Using FastText models for robust embeddings","url":"/mschumacher/using-fasttext-models-for-robust-embeddings?scriptVersionId=2394086","versionNumber":4,"hasVersionNumber":true,"isDeleted":false,"dockerImage":{"scriptVersionId":2394086,"languageName":"Python","dockerImageVersionId":46,"dockerImageVersionCreationDate":"2018-02-04T23:16:27.09Z","dockerImageTag":"kaggle/python","dockerImageDigest":"0f4089a83e4f38898dc3a50aa6c756cbefaf8a25ec5811917257a60099c5af16"}},{"id":2374429,"isForkParent":false,"isNotebook":true,"languageName":"Python","lastRunTime":"2018-02-07T13:08:06.21Z","linesChangedFromPrevious":0,"linesDeletedFromPrevious":2,"linesInsertedFromPrevious":2,"outputFilesTotalSizeBytes":276635,"runInfo":{"dockerfileUrl":"https://github.com/Kaggle/docker-python/blob/master/Dockerfile","dockerHubUrl":"https://registry.hub.docker.com/u/kaggle/python/","dockerImageId":"sha256:c81fe0a86a684b05f63f50d75dd4307c989db3810d2d425633989b50ceda959d","dockerImageName":"gcr.io/kaggle-images/python","exitCode":0,"failureMessage":"","isValidStatus":true,"runTimeSeconds":10.1293621199438,"succeeded":true,"timeoutExceeded":false,"usedAllSpace":false},"status":"complete","title":"Using FastText models for robust embeddings","url":"/mschumacher/using-fasttext-models-for-robust-embeddings?scriptVersionId=2374429","versionNumber":3,"hasVersionNumber":true,"isDeleted":false,"dockerImage":{"scriptVersionId":2374429,"languageName":"Python","dockerImageVersionId":46,"dockerImageVersionCreationDate":"2018-02-04T23:16:27.09Z","dockerImageTag":"kaggle/python","dockerImageDigest":"0f4089a83e4f38898dc3a50aa6c756cbefaf8a25ec5811917257a60099c5af16"}},{"id":2374371,"isForkParent":false,"isNotebook":true,"languageName":"Python","lastRunTime":"2018-02-07T13:03:17.693Z","linesChangedFromPrevious":0,"linesDeletedFromPrevious":11,"linesInsertedFromPrevious":15,"outputFilesTotalSizeBytes":276598,"runInfo":{"dockerfileUrl":"https://github.com/Kaggle/docker-python/blob/master/Dockerfile","dockerHubUrl":"https://registry.hub.docker.com/u/kaggle/python/","dockerImageId":"sha256:c81fe0a86a684b05f63f50d75dd4307c989db3810d2d425633989b50ceda959d","dockerImageName":"gcr.io/kaggle-images/python","exitCode":0,"failureMessage":"","isValidStatus":true,"runTimeSeconds":9.74764848407358,"succeeded":true,"timeoutExceeded":false,"usedAllSpace":false},"status":"complete","title":"Using FastText models for robust embeddings","url":"/mschumacher/using-fasttext-models-for-robust-embeddings?scriptVersionId=2374371","versionNumber":2,"hasVersionNumber":true,"isDeleted":false,"dockerImage":{"scriptVersionId":2374371,"languageName":"Python","dockerImageVersionId":46,"dockerImageVersionCreationDate":"2018-02-04T23:16:27.09Z","dockerImageTag":"kaggle/python","dockerImageDigest":"0f4089a83e4f38898dc3a50aa6c756cbefaf8a25ec5811917257a60099c5af16"}},{"id":2374197,"isForkParent":false,"isNotebook":true,"languageName":"Python","lastRunTime":"2018-02-07T12:47:15.36Z","linesChangedFromPrevious":0,"linesDeletedFromPrevious":1,"linesInsertedFromPrevious":1,"outputFilesTotalSizeBytes":275831,"runInfo":{"dockerfileUrl":"https://github.com/Kaggle/docker-python/blob/master/Dockerfile","dockerHubUrl":"https://registry.hub.docker.com/u/kaggle/python/","dockerImageId":"sha256:c81fe0a86a684b05f63f50d75dd4307c989db3810d2d425633989b50ceda959d","dockerImageName":"gcr.io/kaggle-images/python","exitCode":0,"failureMessage":"","isValidStatus":true,"runTimeSeconds":9.90421881107613,"succeeded":true,"timeoutExceeded":false,"usedAllSpace":false},"status":"complete","title":"Using FastText models for robust embeddings","url":"/mschumacher/using-fasttext-models-for-robust-embeddings?scriptVersionId=2374197","versionNumber":1,"hasVersionNumber":true,"isDeleted":false,"dockerImage":{"scriptVersionId":2374197,"languageName":"Python","dockerImageVersionId":46,"dockerImageVersionCreationDate":"2018-02-04T23:16:27.09Z","dockerImageTag":"kaggle/python","dockerImageDigest":"0f4089a83e4f38898dc3a50aa6c756cbefaf8a25ec5811917257a60099c5af16"}}],"sanitizeHtml":false,"initialScriptVersionId":2456848,"initialTab":null,"baseUrl":"/mschumacher/using-fasttext-models-for-robust-embeddings","kernelDeletionUrl":"/kernels/604344/delete","isAdmin":false,"datasetHidden":false,"readOnly":false,"scriptIsLanguageTemplate":false,"rerunScriptUrl":"/kernels/rerun?id=2456848","dataSources":[{"imageUrl":"https://kaggle2.blob.core.windows.net/competitions/kaggle/8076/logos/thumb76_76.png?t=2017-12-15-21-29-57","sourceUrl":"/c/jigsaw-toxic-comment-classification-challenge","slug":"jigsaw-toxic-comment-classification-challenge","lastUpdated":"2017-12-19T15:38:59.253Z","overview":"Identify and classify toxic online comments","sourceType":"competition","sourceId":8076,"descriptionMimeType":"text/markdown","deleted":false,"private":false,"privateButVisible":false,"name":"Toxic Comment Classification Challenge","description":"You are provided with a large number of Wikipedia comments which have been labeled by human raters for toxic behavior. The types of toxicity are:\n\n - `toxic`\n - `severe_toxic`\n - `obscene`\n - `threat`\n - `insult`\n - `identity_hate`\n\nYou must create a model which predicts a probability of each type of toxicity for each comment.\n\n## File descriptions\n\n*   **train.csv** - the training set, contains comments with their binary labels\n*   **test.csv** - the test set, you must predict the toxicity probabilities for these comments. To deter hand labeling, the test set contains some comments which are not included in scoring.\n*   **sample_submission.csv** - a sample submission file in the correct format\n","type":"dataSource","children":[{"size":1464269,"fullPath":"../input/sample_submission.csv","previewUrl":"/Scripts/ScriptCompetitionInputFilePreview?competitionId=8076\u0026relativePath=sample_submission.csv","downloadUrl":"/c/jigsaw-toxic-comment-classification-challenge/download/sample_submission.csv","fileType":".csv","validationErrors":null,"name":"sample_submission.csv","description":null,"type":"file","children":[],"collapsed":false,"info":{"metrics":null},"settings":{"csvSettings":null,"bigQuerySettings":null}},{"size":24577258,"fullPath":"../input/test.csv","previewUrl":"/Scripts/ScriptCompetitionInputFilePreview?competitionId=8076\u0026relativePath=test.csv","downloadUrl":"/c/jigsaw-toxic-comment-classification-challenge/download/test.csv","fileType":".csv","validationErrors":null,"name":"test.csv","description":null,"type":"file","children":[],"collapsed":false,"info":{"metrics":null},"settings":{"csvSettings":null,"bigQuerySettings":null}},{"size":27619914,"fullPath":"../input/train.csv","previewUrl":"/Scripts/ScriptCompetitionInputFilePreview?competitionId=8076\u0026relativePath=train.csv","downloadUrl":"/c/jigsaw-toxic-comment-classification-challenge/download/train.csv","fileType":".csv","validationErrors":null,"name":"train.csv","description":null,"type":"file","children":[],"collapsed":false,"info":{"metrics":null},"settings":{"csvSettings":null,"bigQuerySettings":null}}],"collapsed":false,"info":{"metrics":null},"settings":{"csvSettings":null,"bigQuerySettings":null}}],"forksBaseUrl":"/kernels/forks/604344/0","totalForks":3,"newForkUrl":"/jpmiller/kernels/scripts/new?forkParentScriptVersionId=2456848","isNotebook":true,"isRMarkdown":false,"scriptId":604344,"scriptVersionId":2456848,"scriptVersionHasError":false,"userCanEditScript":false,"showSubmitToCompButtons":false,"submitToCompUrl":"/competitions/kernels/submit","competitionName":"Toxic Comment Classification Challenge","currentScriptVersionIsBusy":false,"statusCallbackUrl":"/kernels/status?id=2456848","forkParentIsDeleted":false,"forkParentUrl":"","forkParentTitle":null,"forkParentAuthorUrl":null,"forkParentAuthorDisplayName":null,"forkDiffUrl":"/mschumacher/using-fasttext-models-for-robust-embeddings/versions#base=0\u0026new=2456848","forkDiffLinesChanged":0,"forkDiffLinesDeleted":0,"forkDiffLinesInserted":0,"voteButton":{"totalVotes":46,"hasAlreadyVotedUp":false,"hasAlreadyVotedDown":false,"canUpvote":true,"canDownvote":false,"voteUpUrl":"/kernels/vote?id=604344","voteDownUrl":null,"voters":[{"avatarThumbnailUrl":"https://kaggle2.blob.core.windows.net/avatars/thumbnails/476223-fb.jpg","displayName":"HardikChauhan","userName":"rquant","profileUrl":"/rquant","tier":"Novice","tierInt":0,"userId":476223},{"avatarThumbnailUrl":"https://kaggle2.blob.core.windows.net/avatars/thumbnails/101136-kg.jpg","displayName":"Ceshine Lee","userName":"ceshine","profileUrl":"/ceshine","tier":"Expert","tierInt":2,"userId":101136},{"avatarThumbnailUrl":"https://kaggle2.blob.core.windows.net/avatars/thumbnails/default-thumb.png","displayName":"Dexter","userName":"lujunjie","profileUrl":"/lujunjie","tier":"Novice","tierInt":0,"userId":1256090},{"avatarThumbnailUrl":"https://kaggle2.blob.core.windows.net/avatars/thumbnails/default-thumb.png","displayName":"Master","userName":"nzabcd","profileUrl":"/nzabcd","tier":"Expert","tierInt":2,"userId":1145061},{"avatarThumbnailUrl":"https://kaggle2.blob.core.windows.net/avatars/thumbnails/339611-kg.jpeg","displayName":"nkrnrnk","userName":"nickreinerink","profileUrl":"/nickreinerink","tier":"Expert","tierInt":2,"userId":339611},{"avatarThumbnailUrl":"https://kaggle2.blob.core.windows.net/avatars/thumbnails/default-thumb.png","displayName":"chrain","userName":"chrain","profileUrl":"/chrain","tier":"Contributor","tierInt":1,"userId":1510965},{"avatarThumbnailUrl":"https://kaggle2.blob.core.windows.net/avatars/thumbnails/default-thumb.png","displayName":"Nitish Kumar","userName":"nitishsingh41","profileUrl":"/nitishsingh41","tier":"Novice","tierInt":0,"userId":1051555},{"avatarThumbnailUrl":"https://kaggle2.blob.core.windows.net/avatars/thumbnails/1034690-gr.jpg","displayName":"Thundo","userName":"thundo","profileUrl":"/thundo","tier":"Novice","tierInt":0,"userId":1034690},{"avatarThumbnailUrl":"https://kaggle2.blob.core.windows.net/avatars/thumbnails/704745-kg.jpg","displayName":"Yuichi Fujikawa","userName":"fujiyuu75","profileUrl":"/fujiyuu75","tier":"Novice","tierInt":0,"userId":704745},{"avatarThumbnailUrl":"https://kaggle2.blob.core.windows.net/avatars/thumbnails/761206-kg.jpg","displayName":"valentin_gut","userName":"valentingut","profileUrl":"/valentingut","tier":"Contributor","tierInt":1,"userId":761206},{"avatarThumbnailUrl":"https://kaggle2.blob.core.windows.net/avatars/thumbnails/417337-fb.jpg","displayName":"Bojan Tunguz","userName":"tunguz","profileUrl":"/tunguz","tier":"Master","tierInt":3,"userId":417337},{"avatarThumbnailUrl":"https://kaggle2.blob.core.windows.net/avatars/thumbnails/1162710-kg.jpg","displayName":"Dmitry Senyushkin","userName":"albizar","profileUrl":"/albizar","tier":"Novice","tierInt":0,"userId":1162710},{"avatarThumbnailUrl":"https://kaggle2.blob.core.windows.net/avatars/thumbnails/default-thumb.png","displayName":"Andrii Gogniat","userName":"gacoger","profileUrl":"/gacoger","tier":"Novice","tierInt":0,"userId":1308622},{"avatarThumbnailUrl":"https://kaggle2.blob.core.windows.net/avatars/thumbnails/default-thumb.png","displayName":"pvdhn","userName":"pvdhna","profileUrl":"/pvdhna","tier":"Novice","tierInt":0,"userId":466811},{"avatarThumbnailUrl":"https://kaggle2.blob.core.windows.net/avatars/thumbnails/109047-gp.jpg","displayName":"Ubique","userName":"ubique","profileUrl":"/ubique","tier":"Expert","tierInt":2,"userId":109047},{"avatarThumbnailUrl":"https://kaggle2.blob.core.windows.net/avatars/thumbnails/298479-fb.jpg","displayName":"Bernd Allmendinger","userName":"allmendinger","profileUrl":"/allmendinger","tier":"Expert","tierInt":2,"userId":298479},{"avatarThumbnailUrl":"https://kaggle2.blob.core.windows.net/avatars/thumbnails/256849-gr.jpg","displayName":"Fabian Linzberger","userName":"lefant","profileUrl":"/lefant","tier":"Expert","tierInt":2,"userId":256849},{"avatarThumbnailUrl":"https://kaggle2.blob.core.windows.net/avatars/thumbnails/345693-kg.jpg","displayName":"Abhilash Awasthi","userName":"abhilashawasthi","profileUrl":"/abhilashawasthi","tier":"Master","tierInt":3,"userId":345693},{"avatarThumbnailUrl":"https://kaggle2.blob.core.windows.net/avatars/thumbnails/1622443-gr.jpg","displayName":"Jared Chung","userName":"chung1","profileUrl":"/chung1","tier":"Novice","tierInt":0,"userId":1622443},{"avatarThumbnailUrl":"https://kaggle2.blob.core.windows.net/avatars/thumbnails/1192238-kg.jpg","displayName":"action","userName":"action","profileUrl":"/action","tier":"Novice","tierInt":0,"userId":1192238},{"avatarThumbnailUrl":"https://kaggle2.blob.core.windows.net/avatars/thumbnails/759141-kg.jpeg","displayName":"SteeveHuang","userName":"huangkh19951228","profileUrl":"/huangkh19951228","tier":"Expert","tierInt":2,"userId":759141},{"avatarThumbnailUrl":"https://kaggle2.blob.core.windows.net/avatars/thumbnails/610195-kg.jpg","displayName":"hxidkd","userName":"hxidkd","profileUrl":"/hxidkd","tier":"Novice","tierInt":0,"userId":610195},{"avatarThumbnailUrl":"https://kaggle2.blob.core.windows.net/avatars/thumbnails/905442-kg.JPG","displayName":"Dhaval Patel","userName":"dhavalpatel1990","profileUrl":"/dhavalpatel1990","tier":"Contributor","tierInt":1,"userId":905442},{"avatarThumbnailUrl":"https://kaggle2.blob.core.windows.net/avatars/thumbnails/1327694-gr.jpg","displayName":"HankMoody","userName":"jeremypoulain","profileUrl":"/jeremypoulain","tier":"Novice","tierInt":0,"userId":1327694},{"avatarThumbnailUrl":"https://kaggle2.blob.core.windows.net/avatars/thumbnails/7490-gr.jpg","displayName":"Larry Freeman","userName":"larryfreeman","profileUrl":"/larryfreeman","tier":"Expert","tierInt":2,"userId":7490},{"avatarThumbnailUrl":"https://kaggle2.blob.core.windows.net/avatars/thumbnails/1605360-fb.jpg","displayName":"Nathan Wilcox","userName":"ethranes","profileUrl":"/ethranes","tier":"Contributor","tierInt":1,"userId":1605360},{"avatarThumbnailUrl":"https://kaggle2.blob.core.windows.net/avatars/thumbnails/default-thumb.png","displayName":"NoSegfault","userName":"zli117","profileUrl":"/zli117","tier":"Novice","tierInt":0,"userId":688468},{"avatarThumbnailUrl":"https://kaggle2.blob.core.windows.net/avatars/thumbnails/627861-fb.jpg","displayName":"freeCodeCamp","userName":"free-code-camp","profileUrl":"/free-code-camp","tier":"Novice","tierInt":0,"userId":627861},{"avatarThumbnailUrl":"https://kaggle2.blob.core.windows.net/avatars/thumbnails/default-thumb.png","displayName":"01home","userName":"a01home","profileUrl":"/a01home","tier":"Novice","tierInt":0,"userId":1556136},{"avatarThumbnailUrl":"https://kaggle2.blob.core.windows.net/avatars/thumbnails/551990-kg.png","displayName":"Cheng","userName":"chengju","profileUrl":"/chengju","tier":"Novice","tierInt":0,"userId":551990},{"avatarThumbnailUrl":"https://kaggle2.blob.core.windows.net/avatars/thumbnails/default-thumb.png","displayName":"Sang-Ki Ko","userName":"narame7","profileUrl":"/narame7","tier":"Contributor","tierInt":1,"userId":1254425},{"avatarThumbnailUrl":"https://kaggle2.blob.core.windows.net/avatars/thumbnails/295574-gp.jpg","displayName":"Alexey Samoylov","userName":"tibhar940","profileUrl":"/tibhar940","tier":"Contributor","tierInt":1,"userId":295574},{"avatarThumbnailUrl":"https://kaggle2.blob.core.windows.net/avatars/thumbnails/418526-kg.jpg","displayName":"Rahul Venkatesh Kumar","userName":"rahulvks","profileUrl":"/rahulvks","tier":"Expert","tierInt":2,"userId":418526},{"avatarThumbnailUrl":"https://kaggle2.blob.core.windows.net/avatars/thumbnails/618508-kg.jpg","displayName":"Maximilian Hahn","userName":"maximilianhahn","profileUrl":"/maximilianhahn","tier":"Contributor","tierInt":1,"userId":618508},{"avatarThumbnailUrl":"https://kaggle2.blob.core.windows.net/avatars/thumbnails/667481-gp.jpg","displayName":"AnirudhBhardwaj","userName":"anirudhsekar96","profileUrl":"/anirudhsekar96","tier":"Contributor","tierInt":1,"userId":667481},{"avatarThumbnailUrl":"https://kaggle2.blob.core.windows.net/avatars/thumbnails/156004-fb.jpg","displayName":"Titipat Achakulwisut","userName":"titipata","profileUrl":"/titipata","tier":"Contributor","tierInt":1,"userId":156004},{"avatarThumbnailUrl":"https://kaggle2.blob.core.windows.net/avatars/thumbnails/default-thumb.png","displayName":"thousandvoices","userName":"thousandvoices","profileUrl":"/thousandvoices","tier":"Master","tierInt":3,"userId":976501},{"avatarThumbnailUrl":"https://kaggle2.blob.core.windows.net/avatars/thumbnails/360532-kg.jpeg","displayName":"giim","userName":"gimunu","profileUrl":"/gimunu","tier":"Contributor","tierInt":1,"userId":360532},{"avatarThumbnailUrl":"https://kaggle2.blob.core.windows.net/avatars/thumbnails/547230-fb.jpg","displayName":"ParvezRafi","userName":"rafiparvez","profileUrl":"/rafiparvez","tier":"Novice","tierInt":0,"userId":547230},{"avatarThumbnailUrl":"https://kaggle2.blob.core.windows.net/avatars/thumbnails/1015449-kg.jpg","displayName":"Valerio Russo","userName":"russovalerio","profileUrl":"/russovalerio","tier":"Novice","tierInt":0,"userId":1015449},{"avatarThumbnailUrl":"https://kaggle2.blob.core.windows.net/avatars/thumbnails/default-thumb.png","displayName":"Isuru Gunasekara","userName":"isurug","profileUrl":"/isurug","tier":"Novice","tierInt":0,"userId":1532473},{"avatarThumbnailUrl":"https://kaggle2.blob.core.windows.net/avatars/thumbnails/350936-kg.jpg","displayName":"CSAdu","userName":"strideradu","profileUrl":"/strideradu","tier":"Expert","tierInt":2,"userId":350936},{"avatarThumbnailUrl":"https://kaggle2.blob.core.windows.net/avatars/thumbnails/1156413-kg.jpg","displayName":"\u003c^..^\u003e","userName":"brightertiger","profileUrl":"/brightertiger","tier":"Expert","tierInt":2,"userId":1156413},{"avatarThumbnailUrl":"https://kaggle2.blob.core.windows.net/avatars/thumbnails/default-thumb.png","displayName":"Jean-Luc Collet","userName":"jlcollet","profileUrl":"/jlcollet","tier":"Novice","tierInt":0,"userId":1496236},{"avatarThumbnailUrl":"https://kaggle2.blob.core.windows.net/avatars/thumbnails/109123-gr.jpg","displayName":"Dan Ofer","userName":"danofer","profileUrl":"/danofer","tier":"Expert","tierInt":2,"userId":109123},{"avatarThumbnailUrl":"https://kaggle2.blob.core.windows.net/avatars/thumbnails/632012-kg.jpg","displayName":"Mrugank Akarte","userName":"mrugankakarte","profileUrl":"/mrugankakarte","tier":"Contributor","tierInt":1,"userId":632012}],"currentUserInfo":{"avatarThumbnailUrl":"https://kaggle2.blob.core.windows.net/avatars/thumbnails/360751-fb.jpg","displayName":"JohnM","userName":"jpmiller","profileUrl":"/jpmiller","tier":"Expert","tierInt":2,"userId":360751},"showVoters":true,"alwaysShowVoters":true},"dateUpdated":"2018-02-12T13:15:44.943Z","userName":"Max Schumacher","userUrl":"/mschumacher","userAvatarImageUrl":"https://kaggle2.blob.core.windows.net/avatars/thumbnails/48845-gr.jpg","parentName":"Toxic Comment Classification Challenge","parentUrl":"/c/jigsaw-toxic-comment-classification-challenge","scriptLanguage":"Python notebook","totalViews":3892,"title":"Using FastText models for robust embeddings","titleUrl":"/mschumacher/using-fasttext-models-for-robust-embeddings","thumbnailImageUrl":"https://kaggle2.blob.core.windows.net/competitions/kaggle/8076/logos/thumb76_76.png?t=2017-12-15-21-29-57","isPrivate":false,"isCodeSubmission":false,"submission":null,"menuLinks":[{"href":null,"text":"Notebook","title":"Notebook","tab":"notebook","count":null,"showZeroCountExplicitly":false},{"href":null,"text":"Code","title":"Code","tab":"code","count":null,"showZeroCountExplicitly":false},{"href":null,"text":"Data","title":"Data","tab":"data","count":1,"showZeroCountExplicitly":false},{"href":null,"text":"Comments","title":"Comments","tab":"comments","count":24,"showZeroCountExplicitly":true},{"href":null,"text":"Log","title":"Log","tab":"log","count":null,"showZeroCountExplicitly":false},{"href":null,"text":"Versions","title":"Versions","tab":"versions","count":8,"showZeroCountExplicitly":false},{"href":null,"text":"Forks","title":"Forks","tab":"forks","count":3,"showZeroCountExplicitly":false}],"rightMenuLinks":[],"callToAction":{"href":"/jpmiller/kernels/notebooks/new?forkParentScriptVersionId=2456848","text":"Fork Notebook","title":"Fork Notebook","tab":null,"count":null,"showZeroCountExplicitly":false},"topic":{"allowAttachments":false,"canDownvote":true,"comment":null,"commentList":null,"id":49170,"isDeleted":false,"isLocked":false,"isPinned":false,"isSpammed":false,"isSubscribed":false,"parentName":null,"parentUrl":null,"title":null},"medal":"silver","categories":{"categories":[],"type":"script"},"canSeeUpvoteSuggestion":true,"allowPublicPrivateTransition":false,"suggestions":[{"entityType":"kernel","entityId":499316,"title":"NB-SVM strong linear baseline","entityUrl":"/jhoward/nb-svm-strong-linear-baseline","thumbnailImageUrl":"https://kaggle2.blob.core.windows.net/competitions/kaggle/8076/logos/thumb76_76.png?t=2017-12-15-21-29-57","owner":{"id":3256,"imageUrl":"https://kaggle2.blob.core.windows.net/avatars/thumbnails/3256.png","isOrganization":false,"name":"Jeremy Howard","profileUrl":"/jhoward","slug":"jhoward","maxFileSizeBytes":null,"userTier":null}},{"entityType":"kernel","entityId":505100,"title":"Stop the S@#$ - Toxic Comments EDA","entityUrl":"/jagangupta/stop-the-s-toxic-comments-eda","thumbnailImageUrl":"https://kaggle2.blob.core.windows.net/competitions/kaggle/8076/logos/thumb76_76.png?t=2017-12-15-21-29-57","owner":{"id":485000,"imageUrl":"https://kaggle2.blob.core.windows.net/avatars/thumbnails/485000-kg.jpg","isOrganization":false,"name":"Jagan","profileUrl":"/jagangupta","slug":"jagangupta","maxFileSizeBytes":null,"userTier":null}},{"entityType":"kernel","entityId":499449,"title":"Keras - Bidirectional LSTM baseline ( lb 0.069)","entityUrl":"/CVxTz/keras-bidirectional-lstm-baseline-lb-0-069","thumbnailImageUrl":"https://kaggle2.blob.core.windows.net/competitions/kaggle/8076/logos/thumb76_76.png?t=2017-12-15-21-29-57","owner":{"id":407476,"imageUrl":"https://kaggle2.blob.core.windows.net/avatars/thumbnails/407476-kg.jpg","isOrganization":false,"name":"CVxTz","profileUrl":"/CVxTz","slug":"CVxTz","maxFileSizeBytes":null,"userTier":null}},{"entityType":"kernel","entityId":511197,"title":"Improved LSTM baseline: GloVe + dropout","entityUrl":"/jhoward/improved-lstm-baseline-glove-dropout","thumbnailImageUrl":"https://kaggle2.blob.core.windows.net/competitions/kaggle/8076/logos/thumb76_76.png?t=2017-12-15-21-29-57","owner":{"id":3256,"imageUrl":"https://kaggle2.blob.core.windows.net/avatars/thumbnails/3256.png","isOrganization":false,"name":"Jeremy Howard","profileUrl":"/jhoward","slug":"jhoward","maxFileSizeBytes":null,"userTier":null}},{"entityType":"kernel","entityId":598159,"title":"Logistic regression with words and char n-grams","entityUrl":"/tunguz/logistic-regression-with-words-and-char-n-grams","thumbnailImageUrl":"https://kaggle2.blob.core.windows.net/competitions/kaggle/8076/logos/thumb76_76.png?t=2017-12-15-21-29-57","owner":{"id":417337,"imageUrl":"https://kaggle2.blob.core.windows.net/avatars/thumbnails/417337-fb.jpg","isOrganization":false,"name":"Bojan Tunguz","profileUrl":"/tunguz","slug":"tunguz","maxFileSizeBytes":null,"userTier":null}}]});performance && performance.mark && performance.mark("ScriptViewer.componentCouldBootstrap");</script>


<form action="https://www.kaggle.com/mschumacher/using-fasttext-models-for-robust-embeddings" id="__AjaxAntiForgeryForm" method="post"><input name="__RequestVerificationToken" type="hidden" value="hfpbLjSppYsZWLggKJXC_mVWD_1y8zaP8DqYuXhc06Rs_Y7-8A0_iMdlookb9efnSm-UBejDFCtuot2DTJ6Ak7xfuPo1"></form>

<script type="text/x-mathjax-config;executed=true">
    MathJax.Hub.Config({
        "HTML-CSS": {
            preferredFont: "TeX",
            availableFonts: ["STIX", "TeX"],
            linebreaks: {
                automatic: true
            },
            EqnChunk: (MathJax.Hub.Browser.isMobile ? 10 : 50)
        },
        tex2jax: {
            inlineMath: [["\\(", "\\)"], ["\\\\(", "\\\\)"]],
            displayMath: [["$$", "$$"], ["\\[", "\\]"]],
            processEscapes: true,
            ignoreClass: "tex2jax_ignore|dno"
        },
        TeX: {
            noUndefined: {
                attributes: {
                    mathcolor: "red",
                    mathbackground: "#FFEEEE",
                    mathsize: "90%"
                }
            }
        },
        Macros: {
            href: "{}"
        },
        skipStartupTypeset: true,
        messageStyle: "none"
    });
</script>

<script type="text/javascript" async="" crossorigin="anonymous" src="./Using FastText models for robust embeddings _ Kaggle_files/MathJax.js"></script>



    </div>

        <div class="site-layout__footer">
            <footer class="site-footer">
    <div class="site-footer__content">
        <div class="site-footer__copyright">
            <span>© 2018 Kaggle Inc</span>
        </div>
        <nav class="site-footer__nav">
            <a href="https://www.kaggle.com/team">Our Team</a>
            <a href="https://www.kaggle.com/terms">Terms</a>
            <a href="https://www.kaggle.com/privacy">Privacy</a>
            <a href="https://www.kaggle.com/contact">Contact/Support</a>
        </nav>
        <nav class="site-footer__social">
            <div data-component-name="SocialIcons" style="display: flex; flex-direction: column; flex: 1 0 auto;"><div data-reactroot="" class="social-icons"><a class="social-icons__link" href="http://www.twitter.com/kaggle" title="Follow Kaggle on Twitter"><i class="fa fa-twitter-square"></i></a><a class="social-icons__link" href="http://www.facebook.com/kaggle" title="Follow Kaggle on Facebook"><i class="fa fa-facebook-square"></i></a><a class="social-icons__link" href="http://www.linkedin.com/company/kaggle" title="Follow Kaggle on LinkedIn"><i class="fa fa-linkedin-square"></i></a></div></div><script>var Kaggle=window.Kaggle||{};Kaggle.State=Kaggle.State||[];Kaggle.State.push();performance && performance.mark && performance.mark("SocialIcons.componentCouldBootstrap");</script>
        </nav>
    </div>
</footer>

        </div>
</div>



<script type="text/javascript">
    var Kaggle = Kaggle || {};

    Kaggle.Current = {
        userId: 360751,
        userProfileUrl: '/jpmiller',
        userDisplayNameEscaped: 'JohnM',
        userThumbnailUrl: 'https://kaggle2.blob.core.windows.net/avatars/thumbnails/360751-fb.jpg',
        userEmail: 'jpmiller.us@gmail.com',
        userIsPhoneVerified: true,
        userName: 'jpmiller',
        tier: 'Expert',
        antiForgeryToken: '-KX0i1GAlWgbaXHCQxRqv_sk616Owb6S7VK-iBvp6lv1KgUHLKY1FHCx69jn3ge1lDGtfzZt7B0S8M9rkj2Kx_Eyjx41',
        isAnonymous: false,
        isFullScreen: false,
        
        
        
        
        
        
        
        
    }
        Kaggle.Current.log = function(){};
        Kaggle.Current.warn = function(){};
    var decodeUserDisplayName = function () {
        var escapedUserDisplayName = Kaggle.Current.userDisplayNameEscaped || "";
        try {
          var textVersion = new DOMParser().parseFromString(escapedUserDisplayName, "text/html").documentElement.textContent;
          if (textVersion) {
              return textVersion;
          }
        } catch(ex) {}
        
        return escapedUserDisplayName;
    }
    Kaggle.Current.userDisplayName = decodeUserDisplayName();
</script>





<script type="text/javascript">
    var Kaggle = Kaggle || {};
    Kaggle.PageMessages = [];
</script>


<script src="./Using FastText models for robust embeddings _ Kaggle_files/kaggle.prism.min.js"></script>









    <!-- Cheers, RD00155D48878Ap. -->

    <script src="./Using FastText models for robust embeddings _ Kaggle_files/app.js"></script>
    
        <script>
            (function() {
                if ('serviceWorker' in navigator) {
                    
                    navigator.serviceWorker.register("/static/assets/service-worker.js").then(function(reg) {
                        
                        reg.onupdatefound = function() {
                            
                            var installingWorker = reg.installing;
                            installingWorker.onstatechange = function() {
                                switch (installingWorker.state) {
                                case 'installed':
                                    if (navigator.serviceWorker.controller) {
                                        
                                        console.log('New or updated content is available.');
                                    } else {
                                        
                                        console.log('Content is now available offline!');
                                    }
                                    break;
                                case 'redundant':
                                    console.error('The installing service worker became redundant.');
                                    break;
                                }
                            };
                        };
                    }).catch(function(e) {
                      console.error('Error during service worker registration:', e);
                    });
                }
            })();
        </script>


<span id="buffer-extension-hover-button" style="display: none; position: absolute; z-index: 8675309; width: 100px; height: 25px; background-image: url(&quot;chrome-extension://noojglkidnpfjbincgijbaiedldjfbhh/data/shared/img/buffer-hover-icon@2x.png&quot;); background-size: 100px 25px; opacity: 0.9; cursor: pointer; top: 187.963px; left: 409.895px;"></span><textarea style="letter-spacing: normal; line-height: 23.38px; font-family: &quot;Atlas Grotesk&quot;, sans-serif; font-weight: 400; font-size: 14px; font-style: normal; text-rendering: auto; text-transform: none; width: 844.034px; text-indent: 0px; padding: 12px 16px; border-width: 0.994318px; box-sizing: border-box; min-height: 0px !important; max-height: none !important; height: 0px !important; visibility: hidden !important; overflow: hidden !important; position: absolute !important; z-index: -1000 !important; top: 0px !important; right: 0px !important;"></textarea></body></html>